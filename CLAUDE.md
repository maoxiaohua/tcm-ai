# TCM-AI ä¸­åŒ»æ™ºèƒ½è¯Šæ–­ç³»ç»Ÿ

## é¡¹ç›®æ¦‚è§ˆ

TCM-AIæ˜¯ä¸€ä¸ªåŸºäºäººå·¥æ™ºèƒ½çš„ä¸­åŒ»æ™ºèƒ½è¯Šæ–­åŠ©æ‰‹ç³»ç»Ÿï¼Œèåˆä¼ ç»Ÿä¸­åŒ»ç†è®ºä¸ç°ä»£AIæŠ€æœ¯ï¼Œä¸ºæ‚£è€…æä¾›ä¸“ä¸šçš„ä¸­åŒ»é—®è¯ŠæœåŠ¡ï¼Œä¸ºåŒ»ç”Ÿæä¾›æ™ºèƒ½çš„è¯Šç–—è¾…åŠ©å·¥å…·ã€‚

### æ ¸å¿ƒåŠŸèƒ½
- **ç»Ÿä¸€é—®è¯ŠæœåŠ¡**: æ ‡å‡†åŒ–AIé©±åŠ¨çš„å¤šè½®å¯¹è¯é—®è¯Šï¼Œç»Ÿä¸€å…¥å£æ¶æ„è®¾è®¡
- **äº”å¤§ååŒ»äººæ ¼**: é›†æˆå¼ ä»²æ™¯ã€å¶å¤©å£«ã€æä¸œå£ã€éƒ‘é’¦å®‰ã€åˆ˜æ¸¡èˆŸäº”ä½ååŒ»çš„è¯Šç–—æ€ç»´æ¨¡å¼
- **æ™ºèƒ½ç—‡çŠ¶åˆ†æ**: åŸºäº47ä¸ªæ•°æ®åº“è¡¨çš„å®Œæ•´ç—‡çŠ¶å…³ç³»ç½‘ç»œåˆ†æç³»ç»Ÿ
- **å¤šæ¨¡æ€è¯Šæ–­**: æ”¯æŒèˆŒè±¡ã€é¢è±¡å›¾ç‰‡çš„AIåˆ†æï¼Œç»“åˆä¼ ç»Ÿä¸­åŒ»æœ›è¯Š
- **ç»Ÿä¸€è®¤è¯ç³»ç»Ÿ**: unified_users/unified_sessionså¤šè¡¨ååŒçš„å®Œæ•´ç”¨æˆ·ç®¡ç†ä½“ç³»
- **AIå¢å¼ºå¤„æ–¹ç³»ç»Ÿ**: æ™ºèƒ½åˆ†æå¼•æ“ã€é£é™©è¯„çº§ã€æ‰¹é‡å¤„ç†çš„ç°ä»£åŒ–å¤„æ–¹ç®¡ç†
- **åŒ»ç–—å®‰å…¨ä¿éšœ**: ç—‡çŠ¶ç¼–é€ æ£€æµ‹ã€è¥¿è¯è¿‡æ»¤ã€åŒ»ç–—è´£ä»»è¾¹ç•Œæ§åˆ¶
- **æ”¯ä»˜ä»£ç…æœåŠ¡**: é›†æˆæ”¯ä»˜å®ã€å¾®ä¿¡æ”¯ä»˜å’Œç¬¬ä¸‰æ–¹ä¸­è¯ä»£ç…é…é€æœåŠ¡
- **æ™ºèƒ½åŒ»ç”Ÿå·¥ä½œå°**: ä¸“ä¸šåŒ–åŒ»ç–—å·¥ä½œç©ºé—´ï¼ŒåŒ…å«å®æ—¶ç»Ÿè®¡ã€AIæ¨èã€æ‚£è€…å…³ç³»ç®¡ç†

## æŠ€æœ¯æ¶æ„

### åˆ†å±‚æ¶æ„è®¾è®¡
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚              API å±‚                 â”‚  FastAPIè·¯ç”±ã€ä¸­é—´ä»¶ã€æƒé™æ§åˆ¶
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚             CORE å±‚                 â”‚  ä¸šåŠ¡é€»è¾‘ã€ç®—æ³•æ ¸å¿ƒã€åŒ»ç–—æ¨¡å—
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚           SERVICES å±‚               â”‚  AIé›†æˆã€å¤–éƒ¨æœåŠ¡ã€ä¸šåŠ¡ç¼–æ’
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚           DATABASE å±‚               â”‚  æ•°æ®è®¿é—®ã€è¿æ¥æ± ã€è¿ç§»ç®¡ç†
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### æŠ€æœ¯æ ˆæ„æˆ

**åç«¯æ ¸å¿ƒ**
- **Webæ¡†æ¶**: FastAPI 0.104.1 + Uvicorn 0.24.0 (é«˜æ€§èƒ½å¼‚æ­¥æ¡†æ¶)
- **AIå¼•æ“**: é˜¿é‡Œäº‘Dashscope 1.14.1 (é€šä¹‰åƒé—®ç³»åˆ—æ¨¡å‹)
- **æ•°æ®å­˜å‚¨**: SQLiteä¸»æ•°æ®åº“ + 47å¼ è¡¨çš„å®Œæ•´æ•°æ®æ¶æ„
- **å‘é‡æ£€ç´¢**: FAISS 1.7.4 (æœ¬åœ°å‘é‡æ•°æ®åº“ï¼Œæ¯«ç§’çº§å“åº”)
- **å›¾åƒå¤„ç†**: PIL 10.1.0 (å¤šæ¨¡æ€å›¾åƒåˆ†æ)
- **ä¸­æ–‡å¤„ç†**: jieba 0.42.1 (ç—‡çŠ¶æ–‡æœ¬åˆ†è¯å’Œåˆ†æ)
- **APIè·¯ç”±**: 19ä¸ªä¸“ä¸šè·¯ç”±æ¨¡å—ï¼Œè¦†ç›–å®Œæ•´ä¸šåŠ¡æµç¨‹

**å‰ç«¯æŠ€æœ¯**
- **åŸç”ŸWebæŠ€æœ¯**: HTML5/CSS3/JavaScript (æ— æ¡†æ¶ä¾èµ–ï¼Œå…¼å®¹æ€§å¼º)
- **å“åº”å¼è®¾è®¡**: æ”¯æŒPCã€å¹³æ¿ã€æ‰‹æœºå¤šç«¯é€‚é…
- **åŠ¨æ€æƒé™**: åŸºäºç”¨æˆ·è§’è‰²çš„ç•Œé¢å’ŒåŠŸèƒ½åŠ¨æ€æ˜¾ç¤º
- **å¯è§†åŒ–**: Canvas/SVG (å†³ç­–æ ‘ã€æ•°æ®å›¾è¡¨ã€åŒ»ç–—å·¥ä½œå°)

**å¤–éƒ¨æœåŠ¡**
- **AIæœåŠ¡**: é˜¿é‡Œäº‘Dashscope API (qwen-max, qwen-vl-max)
- **æ”¯ä»˜é›†æˆ**: æ”¯ä»˜å®ã€å¾®ä¿¡æ”¯ä»˜ API
- **ä»£ç…æœåŠ¡**: ç¬¬ä¸‰æ–¹ä¸­è¯ä»£ç…å•†APIé›†æˆ

## æ ¸å¿ƒä¸šåŠ¡æ¨¡å—

### ğŸš€ ç»Ÿä¸€é—®è¯ŠæœåŠ¡ (v2.5æ–°å¢)
**æ ¸å¿ƒä¼˜åŠ¿**: æ¶ˆé™¤é‡å¤å¼€å‘ï¼Œä¿è¯ä¸€è‡´æ€§ï¼Œä¾¿äºç»´æŠ¤
- **ç»Ÿä¸€å…¥å£**: æ™ºèƒ½å·¥ä½œæµç¨‹ã€åŸç³»ç»Ÿã€åŒ»ç”Ÿå·¥ä½œå°ä½¿ç”¨ç›¸åŒé—®è¯Šé€»è¾‘
- **æœåŠ¡æ¨¡å—**: `UnifiedConsultationService` - å°è£…å®Œæ•´çš„AIé—®è¯ŠåŠŸèƒ½
- **APIæ¥å£**: `/api/consultation/*` - æ ‡å‡†åŒ–é—®è¯ŠAPIé›†åˆ
- **è´¨é‡ä¿è¯**: ä¸åŸç³»ç»Ÿå®Œå…¨ç›¸åŒçš„é—®è¯Šè´¨é‡å’ŒåŒ»ç”Ÿäººæ ¼

### ğŸ¥ æ™ºèƒ½åŒ»ç”Ÿå·¥ä½œå° â­
**æ ¸å¿ƒä»·å€¼**: ä¸“ä¸šåŒ–åŒ»ç–—å·¥ä½œç©ºé—´ï¼Œæ•´åˆç°ä»£åŒ–åŒ»ç–—ç®¡ç†åŠŸèƒ½

**æ™ºèƒ½ä»ªè¡¨æ¿ç³»ç»Ÿ**:
- **å®æ—¶ç»Ÿè®¡é¢æ¿**: ä»Šæ—¥/æœ¬å‘¨/æœ¬æœˆå®¡æŸ¥æ•°æ®çš„åŠ¨æ€å±•ç¤ºå’Œè¶‹åŠ¿åˆ†æ
- **æ™ºèƒ½æé†’ä¸­å¿ƒ**: å¾…å®¡å¤„æ–¹ã€éšè®¿è®¡åˆ’ã€ç´§æ€¥äº‹é¡¹çš„é›†ä¸­ç®¡ç†
- **æ•ˆç‡åˆ†æå›¾è¡¨**: åŸºäºCanvasçš„å¯è§†åŒ–å·¥ä½œæ•ˆç‡å’Œè´¨é‡è¯„ä¼°
- **å¿«é€Ÿæ“ä½œå¯¼èˆª**: ä¸€é”®è·³è½¬æ ¸å¿ƒåŠŸèƒ½ï¼Œä¼˜åŒ–åŒ»ç”Ÿå·¥ä½œæµç¨‹

**AIå¢å¼ºå¤„æ–¹ç®¡ç†**:
- **æ™ºèƒ½å¤„æ–¹åˆ†æ**: prescription_ai_analysisç­‰å¤šè¡¨ååŒçš„AIåˆ†æå¼•æ“
- **é£é™©è¯„çº§ç³»ç»Ÿ**: è‡ªåŠ¨è¯†åˆ«é«˜é£é™©å¤„æ–¹ï¼Œæ™ºèƒ½ä¼˜å…ˆçº§æ’åº
- **æ‰¹é‡å¤„ç†èƒ½åŠ›**: é«˜æ•ˆå¤„ç†å¤§é‡å¤„æ–¹å®¡æŸ¥ä»»åŠ¡
- **æ™ºèƒ½æ¨èå¼•æ“**: AIé©±åŠ¨çš„å¤„æ–¹ä¼˜åŒ–å»ºè®®å’Œæ›¿ä»£æ–¹æ¡ˆ

**æ‚£è€…å…³ç³»ç®¡ç†**:
- **å®Œæ•´ç—…å†æ¡£æ¡ˆ**: è¯Šç–—è®°å½•ã€ç”¨è¯å†å²ã€ç–—æ•ˆè·Ÿè¸ªçš„å…¨ç”Ÿå‘½å‘¨æœŸç®¡ç†
- **æ™ºèƒ½éšè®¿ç³»ç»Ÿ**: è‡ªåŠ¨æé†’å’Œåç»­è¯Šç–—å®‰æ’
- **å¯è§†åŒ–æ—¶é—´çº¿**: ç—…æƒ…å‘å±•å’Œæ²»ç–—æ•ˆæœçš„ç›´è§‚å±•ç¤º
- **æ‚£è€…æ™ºèƒ½åˆ†ç±»**: åŸºäºç—…æƒ…å’Œæ²»ç–—å¤æ‚åº¦çš„è‡ªåŠ¨åˆ†ç±»ç®¡ç†

### æ™ºèƒ½é—®è¯Šç³»ç»Ÿ  
- **å¤šè½®å¯¹è¯ç®¡ç†**: åŸºäºä¸­åŒ»è¯Šç–—æµç¨‹çš„æ™ºèƒ½å¯¹è¯å¼•æ“
- **è¯Šæ–­é˜¶æ®µæ§åˆ¶**: inquiryâ†’diagnosisâ†’prescriptionçš„æ¸è¿›å¼é—®è¯Šæµç¨‹
- **çŸ¥è¯†æ£€ç´¢å¢å¼º**: 200+ç»å…¸ä¸­åŒ»æ–‡æ¡£çš„RAGçŸ¥è¯†åº“æ”¯æŒ
- **å®‰å…¨æ£€æŸ¥æœºåˆ¶**: å®æ—¶æ£€æµ‹ç—‡çŠ¶ç¼–é€ ã€è¥¿è¯æ³„éœ²ã€åŒ»ç–—è¾¹ç•Œæ§åˆ¶

### äº”å¤§ååŒ»äººæ ¼ç³»ç»Ÿ
```
å¼ ä»²æ™¯ - è¾¨è¯è®ºæ²»ï¼Œæ–¹è¯ç›¸åº”ï¼Œé‡è§†å…­ç»ç†è®º
å¶å¤©å£« - æ¸©ç—…å­¦è¯´ï¼Œå«æ°”è¥è¡€ï¼Œç²¾äºæ—¶ä»¤ç—…è¯
æä¸œå£ - è„¾èƒƒå­¦è¯´ï¼Œå‡é˜³ç›Šèƒƒï¼Œé‡è§†åå¤©ä¹‹æœ¬
éƒ‘é’¦å®‰ - ç«ç¥æ´¾ç†è®ºï¼Œé‡è§†é˜³æ°”ï¼Œå–„ç”¨é™„å­æ¸©é˜³
åˆ˜æ¸¡èˆŸ - ç»æ–¹å¤§å¸ˆï¼Œä¸´åºŠå®ç”¨ï¼Œæ³¨é‡ç–—æ•ˆéªŒè¯
```

### æ™ºèƒ½ç—‡çŠ¶åˆ†æç³»ç»Ÿ â­
**å®Œæ•´æ•°æ®æ¶æ„**: åŸºäº47å¼ æ•°æ®åº“è¡¨çš„ä¸“ä¸šä¸­åŒ»ç—‡çŠ¶åˆ†æä½“ç³»
- **æ ¸å¿ƒç—‡çŠ¶è¡¨**: tcm_symptoms, symptom_relationships, symptom_clusters
- **ç–¾ç—…å…³è”**: tcm_diseasesè¡¨æ”¯æŒçš„å®Œæ•´è¯å€™åˆ†æ
- **æ™ºèƒ½ç¼“å­˜**: å¤šçº§ç¼“å­˜ç³»ç»Ÿç¡®ä¿æ¯«ç§’çº§å“åº”
- **AIå­¦ä¹ **: ai_symptom_analysis_logè®°å½•å’Œä¼˜åŒ–åˆ†ææ•ˆæœ

**æ•°æ®è¦†ç›–**: å®Œæ•´ä¸­åŒ»ç—‡çŠ¶åº“ï¼Œæ”¯æŒä¸»ç—‡ã€å…¼ç—‡ã€èˆŒè±¡ã€è„‰è±¡çš„å…¨æ–¹ä½åˆ†æ

### å¤„æ–¹ç®¡ç†ç³»ç»Ÿ
**å®Œæ•´ä¸šåŠ¡é—­ç¯**:
```
AIç”Ÿæˆå¤„æ–¹ â†’ å®‰å…¨æ ¡éªŒ â†’ åŒ»ç”Ÿå®¡æŸ¥ â†’ æ‚£è€…ç¡®è®¤ â†’ æ”¯ä»˜è®¢å• â†’ ä»£ç…é…é€ â†’ æœåŠ¡å®Œæˆ
```

**å®‰å…¨ä¿éšœæœºåˆ¶**:
- **å›è‡£ä½ä½¿åˆ†æ**: æ™ºèƒ½è¯†åˆ«æ–¹å‰‚é…ä¼ç»“æ„
- **å‰‚é‡å®‰å…¨æ£€æŸ¥**: è¯æç”¨é‡å®‰å…¨èŒƒå›´éªŒè¯
- **é…ä¼ç¦å¿Œæ£€æŸ¥**: ä¸­è¯ç›¸äº’ä½œç”¨å®‰å…¨è¯„ä¼°

### å†³ç­–æ ‘æ„å»ºç³»ç»Ÿ â­
**åŒ»ç”Ÿè¯Šç–—æ€ç»´å¯è§†åŒ–å·¥å…·**:
- **å¯è§†åŒ–æ„å»º**: doctor_decision_treeè·¯ç”±æ”¯æŒçš„äº¤äº’å¼å†³ç­–æ ‘æ„å»º
- **èŠ‚ç‚¹æ™ºèƒ½è®¾è®¡**: è‡ªåŠ¨æ–‡æœ¬æ¢è¡Œã€å†…å®¹ç®¡ç†ã€ç¼–è¾‘ä½“éªŒä¼˜åŒ–
- **æ€ç»´æ¨¡å¼ä¿å­˜**: ä¸ä¸´åºŠè¯Šç–—æ¨¡å¼çš„æ·±åº¦é›†æˆ
- **AIä¸ªæ€§åŒ–**: åŸºäºåŒ»ç”Ÿå†³ç­–æ ‘çš„æ™ºèƒ½é—®è¯Šå®šåˆ¶æœåŠ¡

### ä¸´åºŠæ€ç»´åº“ç³»ç»Ÿ
**åŒ»ç”Ÿè¯Šç–—ç»éªŒç®¡ç†**:
- **æ¨¡å¼æå–**: è‡ªåŠ¨åˆ†æä¸´åºŠå†³ç­–é€»è¾‘å’Œæ²»ç–—åŸåˆ™
- **ç»“æ„åŒ–å­˜å‚¨**: åŸºäºæ•°æ®åº“çš„è§„èŒƒåŒ–è¯Šç–—ç»éªŒå­˜å‚¨
- **æ™ºèƒ½åŒ¹é…**: æ ¹æ®æ‚£è€…ç—‡çŠ¶åŒ¹é…ç›¸å…³ä¸´åºŠç»éªŒ
- **AIé›†æˆ**: ä¸ç»Ÿä¸€é—®è¯ŠæœåŠ¡çš„æ·±åº¦èåˆ

## ç³»ç»Ÿå‘½ä»¤

### æœåŠ¡å¯åŠ¨
```bash
# å¼€å‘ç¯å¢ƒ
python api/main.py

# ç”Ÿäº§ç¯å¢ƒ (å®å¡”é¢æ¿) âš ï¸ é‡è¦ï¼šä»£ç ä¿®æ”¹åå¿…é¡»é‡å¯æœåŠ¡
python3 /opt/tcm-ai/api/main.py  # å®å¡”é¢æ¿Pythoné¡¹ç›®å¯åŠ¨æ–¹å¼
# æ³¨æ„: ä½¿ç”¨å®å¡”é¢æ¿ç®¡ç†Pythoné¡¹ç›®ï¼ŒSSLè¯ä¹¦å’Œè¿›ç¨‹ç®¡ç†ç”±å®å¡”è´Ÿè´£
# é‡å¯æœåŠ¡: åœ¨å®å¡”é¢æ¿ -> Pythoné¡¹ç›® -> é‡å¯é¡¹ç›®
# æŸ¥çœ‹æ—¥å¿—: å®å¡”é¢æ¿ -> Pythoné¡¹ç›® -> æ—¥å¿—æŸ¥çœ‹

# æµ‹è¯•ç¯å¢ƒ
python api/main_test_8002.py
```

### æ•°æ®åº“ç®¡ç†
```bash
# æ•°æ®åº“æ¶æ„æŸ¥çœ‹
sqlite3 /opt/tcm-ai/data/user_history.sqlite ".tables"

# ä¸»æ•°æ®åº“è¿ç§» (æ ¹æ®éœ€è¦é€‰æ‹©åˆé€‚ç‰ˆæœ¬)
sqlite3 /opt/tcm-ai/data/user_history.sqlite < database/migrations/010_unified_account_system_fixed.sql

# æ•°æ®åº“å¤‡ä»½
sqlite3 /opt/tcm-ai/data/user_history.sqlite ".backup backup_$(date +%Y%m%d_%H%M%S).db"

# ç³»ç»ŸçŠ¶æ€æ£€æŸ¥
curl -X GET "http://localhost:8000/api/symptom/database/stats"
curl -X GET "http://localhost:8000/api/admin/system-info"
```

### æµ‹è¯•æ‰§è¡Œ
```bash
# å®Œæ•´æµ‹è¯•å¥—ä»¶
pytest

# å†’çƒŸæµ‹è¯• (éƒ¨ç½²éªŒè¯)
pytest tests/smoke/ -v

# å›å½’æµ‹è¯• (åŠŸèƒ½ç¨³å®šæ€§)
pytest -m regression

# åŒ»ç–—å®‰å…¨æµ‹è¯•
pytest tests/test_medical_diagnosis_safety.py
pytest tests/test_symptom_fabrication_fix.py
```

### ç³»ç»Ÿç›‘æ§
```bash
# æ€§èƒ½ç›‘æ§
bash scripts/monitor_competition.sh

# å®‰å…¨æ£€æŸ¥
bash scripts/quick_security.sh

# ç³»ç»Ÿé¢„çƒ­
bash scripts/warmup_for_competition.sh
```

## å¼€å‘è§„èŒƒ

### Gitæäº¤è§„èŒƒ âš ï¸
**é‡è¦**: åŒºåˆ†é—®é¢˜è§£å†³çš„ä¸åŒé˜¶æ®µï¼Œåˆç†ä½¿ç”¨Gitå¤‡ä»½

**æäº¤ç­–ç•¥**:
1. **é—®é¢˜è§£å†³å‰å¤‡ä»½** âš ï¸ **å¿…é¡»æ‰§è¡Œ**
   - å¼€å§‹è§£å†³æ–°é—®é¢˜/bugå‰: `git add -A && git commit -m "ğŸ”„ ä¿®æ”¹å‰å¤‡ä»½: [æè¿°å³å°†è§£å†³çš„é—®é¢˜]"`
   
2. **é—®é¢˜è§£å†³è¿‡ç¨‹ä¸­** âœ… **æ— éœ€é¢‘ç¹å¤‡ä»½**
   - åŒä¸€é—®é¢˜çš„å¤šæ¬¡å°è¯•ä¿®æ”¹ã€è°ƒè¯•ã€æµ‹è¯•è¿‡ç¨‹ä¸­ä¸éœ€è¦æ¯æ¬¡å¤‡ä»½
   - å…è®¸è¿ç»­å¤šæ¬¡ä¿®æ”¹ä»£ç æ¥è§£å†³åŒä¸€ä¸ªé—®é¢˜
   
3. **é—®é¢˜è§£å†³å®Œæˆå** âš ï¸ **å¿…é¡»æäº¤**
   - é—®é¢˜å®Œå…¨è§£å†³å: `git add -A && git commit -m "[ç±»å‹] [ç®€è¦æè¿°]: [è¯¦ç»†è¯´æ˜]"`

**ä»€ä¹ˆæ—¶å€™éœ€è¦å¤‡ä»½**:
- âœ… å¼€å§‹è§£å†³æ–°é—®é¢˜å‰
- âœ… åˆ‡æ¢åˆ°ä¸åŒé—®é¢˜å‰  
- âœ… åŠŸèƒ½å¼€å‘å®Œæˆå
- âŒ åŒä¸€é—®é¢˜çš„è°ƒè¯•è¿‡ç¨‹ä¸­
- âŒ ä¿®å¤bugçš„å¤šæ¬¡å°è¯•ä¸­

**æäº¤ç±»å‹**:
- ğŸ› ä¿®å¤bug
- âœ¨ æ–°åŠŸèƒ½  
- ğŸ”§ é…ç½®ä¿®æ”¹
- ğŸ“š æ–‡æ¡£æ›´æ–°
- ğŸ—ï¸ æ¶æ„è°ƒæ•´
- ğŸ§ª æµ‹è¯•ç›¸å…³

**æäº¤æ¨¡æ¿**:
```bash
git commit -m "ğŸ› ä¿®å¤[é—®é¢˜æè¿°]

- [å…·ä½“ä¿®æ”¹1]
- [å…·ä½“ä¿®æ”¹2]
- [å½±å“è¯´æ˜]

ğŸ¤– Generated with [Claude Code](https://claude.ai/code)

Co-Authored-By: Claude <noreply@anthropic.com>"
```

### ä»£ç é£æ ¼
- **ç¼–ç æ ‡å‡†**: UTF-8, Python 3.11+
- **æ–‡æ¡£è§„èŒƒ**: å‡½æ•°/ç±»å¿…é¡»åŒ…å«è¯¦ç»†æ–‡æ¡£å­—ç¬¦ä¸²
- **ç±»å‹æç¤º**: å¼ºåˆ¶ä½¿ç”¨typingç±»å‹æç¤º
- **å‘½åè§„èŒƒ**: snake_case (å‡½æ•°/å˜é‡), PascalCase (ç±»)

### ğŸ”§ å¼€å‘é”™è¯¯é˜²èŒƒ 
**é‡è¦**: å¼€å§‹å¼€å‘å‰è¯·å…ˆé˜…è¯» `DEVELOPMENT_GUIDELINES.md`ï¼Œé¿å…é‡å¤æ€§é”™è¯¯ï¼š

- **APIç«¯ç‚¹é”™è¯¯**: `/chat` vs `/chat_with_ai` vs `/api/consultation/chat`
- **å‚æ•°æ ¼å¼ä¸åŒ¹é…**: åŒ»ç”ŸIDæ˜ å°„ (`"1"` â†’ `"zhang_zhongjing"`)
- **å“åº”æ•°æ®ç»“æ„**: `data.reply` vs `result.data.reply`
- **æ•°æ®åº“å­—æ®µå**: `id` vs `uuid`ã€`speciality` vs `specialties`
- **äº‹ä»¶ç»‘å®šæ—¶æœº**: DOMåŠ è½½ã€å¼‚æ­¥å†…å®¹å¤„ç†
- **æ ‡å‡†é”™è¯¯å¤„ç†**: ç»Ÿä¸€çš„try-catchå’Œç”¨æˆ·åé¦ˆæ¨¡å¼

### åŒ»ç–—å®‰å…¨æ ‡å‡† âš ï¸
**ä¸¥æ ¼ç¦æ­¢**:
1. AIæ·»åŠ æ‚£è€…æœªæ˜ç¡®æè¿°çš„ä»»ä½•ç—‡çŠ¶ç»†èŠ‚
2. æ— å›¾åƒæ—¶ç¼–é€ èˆŒè±¡è„‰è±¡ç­‰ä½“å¾æè¿°
3. æ¨èæˆ–æ³„éœ²ä»»ä½•è¥¿è¯åç§°
4. è¶…å‡ºä¸­åŒ»è¯Šç–—èŒƒå›´çš„åŒ»ç–—å»ºè®®

**å¿…é¡»éµå¾ª**:
1. æ‰€æœ‰è¯Šæ–­å»ºè®®åŒ…å«"ä»…ä¾›å‚è€ƒï¼Œå»ºè®®é¢è¯Š"å£°æ˜
2. ä¸¥æ ¼çš„åŒ»ç–—è´£ä»»è¾¹ç•Œæ§åˆ¶
3. å®Œæ•´çš„æ“ä½œå®¡è®¡æ—¥å¿—è®°å½•
4. æ•æ„ŸåŒ»ç–—æ•°æ®è„±æ•å¤„ç†

### APIè®¾è®¡è§„èŒƒ
- **RESTfulè®¾è®¡**: æ ‡å‡†RESTæ¥å£è§„èŒƒ
- **ç»Ÿä¸€å“åº”æ ¼å¼**: `{"success": bool, "message": str, "data": any}`
- **å¼‚å¸¸å¤„ç†**: HTTPException + è¯¦ç»†é”™è¯¯ä¿¡æ¯
- **ç‰ˆæœ¬æ§åˆ¶**: APIç‰ˆæœ¬åŒ–ç®¡ç†

## æ•°æ®åº“æ¶æ„

### ä¸»æ•°æ®åº“è¡¨ç»“æ„ (SQLite - 47å¼ è¡¨)
```sql
-- ç»Ÿä¸€ç”¨æˆ·è®¤è¯ç³»ç»Ÿ
unified_users                   # ç»Ÿä¸€ç”¨æˆ·è¡¨ (æ‚£è€…ã€åŒ»ç”Ÿã€ç®¡ç†å‘˜)
unified_sessions               # ç»Ÿä¸€ä¼šè¯ç®¡ç†
doctors                        # åŒ»ç”Ÿè¯¦ç»†ä¿¡æ¯
user_roles                     # ç”¨æˆ·è§’è‰²ç®¡ç†

-- è¯Šç–—æ ¸å¿ƒç³»ç»Ÿ
consultations                  # é—®è¯Šè®°å½• (ç—‡çŠ¶åˆ†æã€è¯å€™ã€å¯¹è¯è®°å½•)
prescriptions                  # å¤„æ–¹ç®¡ç† (æ–¹å‰‚ã€çŠ¶æ€æµè½¬ã€ç‰ˆæœ¬æ§åˆ¶)
prescription_changes           # å¤„æ–¹å˜æ›´å†å²

-- AIå¢å¼ºå¤„æ–¹ç³»ç»Ÿ
prescription_ai_analysis       # AIå¤„æ–¹åˆ†æç»“æœ
prescription_ai_recommendations # AIå¤„æ–¹æ¨è
prescription_risk_ratings      # å¤„æ–¹é£é™©è¯„çº§

-- æ™ºèƒ½ç—‡çŠ¶åˆ†æç³»ç»Ÿ
tcm_diseases                   # ä¸­åŒ»ç–¾ç—…/è¯å€™è¡¨
tcm_symptoms                   # ç—‡çŠ¶è¡¨ (ä¸»ç—‡ã€å…¼ç—‡ã€èˆŒè±¡ã€è„‰è±¡)
symptom_relationships          # ç—‡çŠ¶å…³ç³»ç½‘ç»œ
symptom_clusters               # ç—‡çŠ¶èšç±»ç¼“å­˜
ai_symptom_analysis_log        # AIåˆ†æå­¦ä¹ æ—¥å¿—

-- åŒ»ç”Ÿå·¥ä½œç³»ç»Ÿ
doctor_work_statistics         # åŒ»ç”Ÿå·¥ä½œç»Ÿè®¡
doctor_availability           # åŒ»ç”Ÿå¯ç”¨æ€§ç®¡ç†
doctor_patient_relationships  # åŒ»æ‚£å…³ç³»ç®¡ç†
doctor_sessions               # åŒ»ç”Ÿä¼šè¯ç®¡ç†

-- è®¢å•æ”¯ä»˜ç³»ç»Ÿ
orders                        # è®¢å•ç®¡ç†
decoction_orders             # ä»£ç…è®¢å•

-- å®‰å…¨å®¡è®¡ç³»ç»Ÿ
audit_logs                    # æ“ä½œå®¡è®¡æ—¥å¿—
security_events              # å®‰å…¨äº‹ä»¶è®°å½•
security_audit_logs          # å®‰å…¨å®¡è®¡è¿½è¸ª
security_alerts              # å®‰å…¨å‘Šè­¦

-- ç³»ç»Ÿç®¡ç†
system_settings              # ç³»ç»Ÿé…ç½®
system_metrics              # ç³»ç»Ÿæ€§èƒ½æŒ‡æ ‡
```

### ç¼“å­˜æ¶æ„
```
L1: å†…å­˜ç¼“å­˜ (æ¯«ç§’çº§)    # çƒ­ç‚¹ç—‡çŠ¶å…³ç³»ã€ç”¨æˆ·ä¼šè¯
L2: SQLiteç¼“å­˜          # æŒä¹…åŒ–ç¼“å­˜æ•°æ®åº“  
L3: Redisé›†ç¾¤ (å¯é€‰)     # åˆ†å¸ƒå¼ç¼“å­˜
```

## éƒ¨ç½²ä¸è¿ç»´

### ç”Ÿäº§ç¯å¢ƒéƒ¨ç½²
```bash
# å®å¡”é¢æ¿Pythoné¡¹ç›®é…ç½®
# 1. åˆ›å»ºPythoné¡¹ç›®: /opt/tcm-ai
# 2. å¯åŠ¨æ–‡ä»¶: /opt/tcm-ai/api/main.py
# 3. ç«¯å£é…ç½®: 8000
# 4. SSLè¯ä¹¦ç®¡ç†: å®å¡”é¢æ¿è‡ªåŠ¨ç®¡ç†

# nginxåå‘ä»£ç† (å®å¡”é¢æ¿è‡ªåŠ¨ç”Ÿæˆ)
# é…ç½®æ–‡ä»¶ä½ç½®ç”±å®å¡”é¢æ¿ç®¡ç†

# æœåŠ¡ç®¡ç†
# é€šè¿‡å®å¡”é¢æ¿ -> Pythoné¡¹ç›®è¿›è¡Œå¯åŠ¨/åœæ­¢/é‡å¯æ“ä½œ
```

### ç¯å¢ƒé…ç½®
- **è¿è¡Œç«¯å£**: 8000 (ç”Ÿäº§), 8002 (æµ‹è¯•)  
- **æ•°æ®è·¯å¾„**: `/opt/tcm-ai/data/`
- **æ—¥å¿—è·¯å¾„**: `/opt/tcm-ai/logs/ + api.log` (å®å¡”é¢æ¿æ—¥å¿—æŸ¥çœ‹)
- **é™æ€èµ„æº**: `/opt/tcm-ai/static/`

### ä¾èµ–æœåŠ¡
- **é˜¿é‡Œäº‘Dashscope**: AIæ¨¡å‹æœåŠ¡ (å¿…éœ€)
- **PostgreSQL**: å‘é‡æ•°æ®åº“ (å¯é€‰ï¼ŒFAISSä¸ºå¤‡é€‰)
- **å®å¡”é¢æ¿**: Pythoné¡¹ç›®ç®¡ç†ï¼ŒSSLè¯ä¹¦ç®¡ç†ï¼Œè‡ªåŠ¨nginxé…ç½®
- **Redis**: åˆ†å¸ƒå¼ç¼“å­˜ (å¯é€‰)

## å®‰å…¨ä¸ç›‘æ§

### å®‰å…¨é˜²æŠ¤
- **RBACæƒé™ç³»ç»Ÿ**: åŸºäºè§’è‰²çš„è®¿é—®æ§åˆ¶
- **JWT + Session**: åŒé‡ä¼šè¯å®‰å…¨æœºåˆ¶  
- **åŒ»ç–—æ•°æ®ä¿æŠ¤**: æ•æ„Ÿä¿¡æ¯è„±æ•ã€å®¡è®¡è¿½è¸ª
- **APIå®‰å…¨**: é˜²SQLæ³¨å…¥ã€å‚æ•°éªŒè¯ã€é¢‘ç‡é™åˆ¶

### ç›‘æ§ä½“ç³»
- **ç³»ç»Ÿç›‘æ§**: CPUã€å†…å­˜ã€ç£ç›˜ä½¿ç”¨ç‡
- **APIç›‘æ§**: å“åº”æ—¶é—´ã€æˆåŠŸç‡ã€å¹¶å‘æ•°
- **åŒ»ç–—å®‰å…¨ç›‘æ§**: ç—‡çŠ¶ç¼–é€ æ£€æµ‹ã€è¥¿è¯è¿‡æ»¤å‘Šè­¦
- **ä¸šåŠ¡ç›‘æ§**: é—®è¯Šé‡ã€å¤„æ–¹å®¡æŸ¥ç‡ã€æ”¯ä»˜æˆåŠŸç‡

## ç‰ˆæœ¬æ›´æ–°è®°å½•

### v2.8 - ç³»ç»Ÿæ¶æ„ç°çŠ¶ç‰ˆ (2025-09-24)
**æ–‡æ¡£åŒæ­¥æ›´æ–°**: åŸºäºå®é™…è¿è¡ŒçŠ¶æ€å…¨é¢æ›´æ–°æ–‡æ¡£ï¼Œç¡®ä¿ä¸å½“å‰ç³»ç»Ÿå®Œå…¨ä¸€è‡´

**å½“å‰ç³»ç»ŸçŠ¶æ€**:
- âœ… **ç»Ÿä¸€è®¤è¯ä½“ç³»**: unified_users, unified_sessionså¤šè¡¨ååŒçš„å®Œæ•´ç”¨æˆ·ç®¡ç†
- âœ… **47å¼ æ•°æ®åº“è¡¨**: è¦†ç›–ç”¨æˆ·ã€è¯Šç–—ã€å¤„æ–¹ã€å®¡è®¡ã€å®‰å…¨çš„å®Œæ•´æ•°æ®æ¶æ„  
- âœ… **19ä¸ªAPIè·¯ç”±æ¨¡å—**: ä»è®¤è¯ã€é—®è¯Šåˆ°æ”¯ä»˜çš„å®Œæ•´ä¸šåŠ¡æµç¨‹è¦†ç›–
- âœ… **AIå¢å¼ºå¤„æ–¹ç³»ç»Ÿ**: prescription_ai_*ç³»åˆ—è¡¨æ”¯æŒçš„æ™ºèƒ½å¤„æ–¹åˆ†æä½“ç³»
- âœ… **åŒ»ç–—å®‰å…¨é˜²æŠ¤**: ç—‡çŠ¶ç¼–é€ æ£€æµ‹ã€åŒ»ç–—è¾¹ç•Œæ§åˆ¶çš„å…¨é¢å®‰å…¨ä¿éšœ
- âœ… **æ™ºèƒ½åŒ»ç”Ÿå·¥ä½œå°**: ä¸“ä¸šåŒ–åŒ»ç–—å·¥ä½œç©ºé—´ï¼Œæ•´åˆç°ä»£åŒ–ç®¡ç†åŠŸèƒ½
- âœ… **å¤šæ¨¡æ€è¯Šæ–­**: èˆŒè±¡ã€é¢è±¡å›¾ç‰‡AIåˆ†æçš„å®Œæ•´é›†æˆ

### v2.6 - æ™ºèƒ½åŒ»ç”Ÿå·¥ä½œå°é‡æ„ç‰ˆ (2025-09-21)
**é‡å¤§é‡æ„**: åŒ»ç”Ÿç•Œé¢ä»"åŠŸèƒ½ä½æ•ˆä¸”æ— æ„ä¹‰"å…¨é¢å‡çº§ä¸ºä¸“ä¸šåŒ»ç–—å·¥ä½œç©ºé—´

**æ ¸å¿ƒåŠŸèƒ½**:
- âœ… æ™ºèƒ½ä»ªè¡¨æ¿: å®æ—¶ç»Ÿè®¡ã€æé†’ä¸­å¿ƒã€æ•ˆç‡å›¾è¡¨ã€å¿«é€Ÿæ“ä½œé¢æ¿
- âœ… AIå¢å¼ºå¤„æ–¹å®¡æŸ¥: æ™ºèƒ½åˆ†æå¼•æ“ã€æ‰¹é‡å¤„ç†ã€é£é™©è¯„çº§ã€7å¼ AIåˆ†ææ•°æ®è¡¨
- âœ… æ‚£è€…å…³ç³»ç®¡ç†: æ¡£æ¡ˆç®¡ç†ã€é¢„çº¦éšè®¿ã€å°±è¯Šæ—¶é—´çº¿ã€æ™ºèƒ½åˆ†ç±»
- âœ… ç»Ÿä¸€è®¤è¯é›†æˆ: å®Œå…¨å…¼å®¹v2.5ç»Ÿä¸€è®¤è¯ç³»ç»Ÿï¼Œæ”¯æŒåŠ¨æ€æƒé™æ§åˆ¶
- âœ… JavaScripté‡æ„: å®Œå…¨é‡å†™å‰ç«¯ä»£ç ï¼Œä¿®å¤è¯­æ³•é”™è¯¯ï¼Œæå‡æ€§èƒ½å’Œç¨³å®šæ€§
- âœ… å†³ç­–æ ‘ä¿®å¤: è§£å†³å†³ç­–æ ‘æ„å»ºå™¨404é—®é¢˜ï¼Œæ¢å¤å¯è§†åŒ–è¯Šç–—æ€ç»´æ„å»ºåŠŸèƒ½

### v2.5 - ç»Ÿä¸€é—®è¯ŠæœåŠ¡ç‰ˆ (2025-09-09)
**æ¶æ„ç»Ÿä¸€**: æ¶ˆé™¤é‡å¤å¼€å‘ï¼Œå»ºç«‹ç»Ÿä¸€é—®è¯ŠæœåŠ¡æ¶æ„

**æ ¸å¿ƒåŠŸèƒ½**:
- âœ… ç»Ÿä¸€é—®è¯ŠæœåŠ¡: `UnifiedConsultationService` å°è£…å®Œæ•´AIé—®è¯ŠåŠŸèƒ½
- âœ… APIæ ‡å‡†åŒ–: `/api/consultation/*` æ ‡å‡†åŒ–é—®è¯ŠAPIé›†åˆ
- âœ… å¤šç«¯å…¼å®¹: æ™ºèƒ½å·¥ä½œæµç¨‹ã€åŸç³»ç»Ÿã€åŒ»ç”Ÿå·¥ä½œå°ç»Ÿä¸€ä½¿ç”¨
- âœ… è´¨é‡ä¿è¯: ä¸åŸç³»ç»Ÿå®Œå…¨ç›¸åŒçš„é—®è¯Šè´¨é‡å’ŒåŒ»ç”Ÿäººæ ¼

### v2.1 - æ™ºèƒ½ç—‡çŠ¶åˆ†æç³»ç»Ÿ (2025-01-09)  
**æ¶æ„åˆ›æ–°**: ä»ç¡¬ç¼–ç ç—‡çŠ¶å…³ç³»å‡çº§ä¸ºAIé©±åŠ¨çš„æ™ºèƒ½åˆ†æç³»ç»Ÿ

**æ ¸å¿ƒåŠŸèƒ½**:
- âœ… ä¸‰å±‚æ™ºèƒ½æ¶æ„: æ¯«ç§’çº§ç¼“å­˜ â†’ 100msæ•°æ®åº“ â†’ 2-3s AIåˆ†æ
- âœ… ç—‡çŠ¶å…³ç³»ç½‘ç»œ: 103ä¸ªç—‡çŠ¶ï¼Œ20+ç—…ç—‡ï¼Œå¤šç»´åº¦å…³ç³»ç®¡ç†
- âœ… æ™ºèƒ½APIæ¥å£: 7ä¸ªç—‡çŠ¶åˆ†æç«¯ç‚¹ï¼Œæ”¯æŒå¿«é€ŸæŸ¥è¯¢å’Œå®Œæ•´åˆ†æ
- âœ… ç½®ä¿¡åº¦è¯„åˆ†: 0-1è¯„åˆ†ç³»ç»Ÿï¼Œæ”¯æŒexpert/ai/literatureå¤šæºæ•°æ®

## å¸¸è§é—®é¢˜è§£å†³

### JavaScriptæŒ‰é’®æ— å“åº”
**é—®é¢˜**: é¡µé¢åŠ è½½æ­£å¸¸ä½†æŒ‰é’®ç‚¹å‡»æ— ååº”ï¼Œæ§åˆ¶å°æ˜¾ç¤ºè¯­æ³•é”™è¯¯

**è§£å†³æ–¹æ¡ˆ**:
1. **try-catchç»“æ„ä¿®å¤**: ç¡®ä¿æ¯ä¸ªtryéƒ½æœ‰å¯¹åº”çš„catch
2. **å˜é‡é‡å¤å£°æ˜**: ä½¿ç”¨å…¨å±€è¾…åŠ©å‡½æ•°é¿å…é‡å¤å£°æ˜
3. **äº‹ä»¶ç»‘å®šæ—¶æœº**: ä½¿ç”¨setTimeoutå¼ºåˆ¶é‡æ–°ç»‘å®šäº‹ä»¶

### æ€§èƒ½ä¼˜åŒ–å»ºè®®
- **ç¼“å­˜å‘½ä¸­ç‡**: ç»´æŒ>80%çš„çƒ­ç‚¹æ•°æ®ç¼“å­˜å‘½ä¸­
- **æ•°æ®åº“å“åº”**: ç¡®ä¿<100msçš„æœ¬åœ°SQLiteå“åº”æ—¶é—´  
- **APIè°ƒç”¨ä¼˜åŒ–**: æ™ºèƒ½ç¼“å­˜é¿å…é‡å¤AIè°ƒç”¨
- **è¿æ¥æ± ç®¡ç†**: åˆç†é…ç½®æ•°æ®åº“è¿æ¥æ± å‚æ•°

### åŒ»ç–—å®‰å…¨æ£€æŸ¥
- **ç—‡çŠ¶ç¼–é€ ç›‘æ§**: å®æ—¶æ£€æµ‹AIæ·»åŠ çš„æœªæè¿°ç—‡çŠ¶
- **è¥¿è¯è¿‡æ»¤éªŒè¯**: ç¡®ä¿çº¯ä¸­åŒ»è¯Šç–—ç¯å¢ƒ
- **åŒ»ç–—è¾¹ç•Œæ§åˆ¶**: ä¸¥æ ¼çš„è´£ä»»èŒƒå›´å’Œå…è´£å£°æ˜
- **å®¡è®¡æ—¥å¿—å®Œæ•´æ€§**: æ‰€æœ‰åŒ»ç–—æ“ä½œçš„å®Œæ•´è¿½æº¯

### ğŸš¨ é‡è¦å¼€å‘æ£€æŸ¥æ¸…å• (æ¯æ¬¡å¼€å‘å‰å¿…è¯»)

#### ğŸ” ç³»ç»Ÿç»“æ„å…¨é¢Review
**åœ¨è¿›è¡Œä»»ä½•ä¿®æ”¹å‰ï¼Œå¿…é¡»å®Œæˆä»¥ä¸‹æ£€æŸ¥**ï¼š

1. **é¡µé¢è·¯ç”±æ£€æŸ¥**ï¼š
   - âœ… ç™»å½•é¡µé¢ï¼š`/login` (FastAPIè·¯ç”± â†’ auth_portal.html)
   - âœ… æ™ºèƒ½é—®è¯Šï¼š`/smart` (FastAPIè·¯ç”± â†’ index_smart_workflow.html)
   - âœ… ç®¡ç†åå°ï¼š`/admin` (FastAPIè·¯ç”± â†’ admin/index.html)
   - âœ… åŒ»ç”Ÿç«¯ï¼š`/doctor` (FastAPIè·¯ç”± â†’ doctor/index.html)
   - âœ… å®å¡”é¢æ¿é…ç½®ï¼šPythoné¡¹ç›® + è‡ªåŠ¨nginxé…ç½®

2. **APIç«¯ç‚¹æ£€æŸ¥**ï¼š
   - âœ… ç»Ÿä¸€é—®è¯Šï¼š`/api/consultation/chat` 
   - âœ… è®¤è¯ç™»å½•ï¼š`/api/auth/login`, `/api/v2/auth/*`, `/api/unified-auth/*`
   - âœ… ç—‡çŠ¶åˆ†æï¼š`/api/symptom/*` (æ™ºèƒ½ç—‡çŠ¶å…³ç³»åˆ†æ)
   - âœ… å¤„æ–¹ç®¡ç†ï¼š`/api/prescription/*` (ç”Ÿæˆã€å®¡æŸ¥ã€ç¡®è®¤)
   - âœ… AIå¤„æ–¹å®¡æŸ¥ï¼š`/api/prescription-ai/*` (åˆ†æã€æ¨èã€é£é™©è¯„ä¼°ã€æ‰¹é‡æ“ä½œ)
   - âœ… åŒ»ç”Ÿç®¡ç†ï¼š`/api/doctor/*` (åŒ»ç”Ÿä¿¡æ¯ã€å·¥ä½œå°æ•°æ®)
   - âœ… æ€ç»´åº“ç®¡ç†ï¼š`/api/save_clinical_pattern`, `/api/get_doctor_patterns`
   - âœ… å†³ç­–æ ‘ç®¡ç†ï¼š`/api/doctor-decision-tree/*`
   - âœ… æ•°æ®åŒæ­¥ï¼š`/api/user-data-sync/*`, `/api/conversation-sync/*`
   - âœ… ç³»ç»Ÿç®¡ç†ï¼š`/api/admin/*`, `/api/database-management/*`
   - âœ… æ”¯ä»˜ä»£ç…ï¼š`/api/payment/*`, `/api/decoction/*`

3. **æ•°æ®åº“è¡¨ç»“æ„**ï¼š
   - âœ… ç»Ÿä¸€ç”¨æˆ·ç³»ç»Ÿï¼š`unified_users`, `unified_sessions`, `user_roles`, `doctors`, `users`
   - âœ… é—®è¯Šç³»ç»Ÿï¼š`consultations`, `prescriptions`, `prescription_changes`
   - âœ… ç—‡çŠ¶åˆ†æï¼š`tcm_symptoms`, `symptom_relationships`, `tcm_diseases`, `symptom_clusters`
   - âœ… AIå¤„æ–¹åˆ†æï¼š`prescription_ai_analysis`, `prescription_ai_recommendations`, `prescription_risk_ratings`
   - âœ… åŒ»ç”Ÿå·¥ä½œï¼š`doctor_work_statistics`, `doctor_availability`, `doctor_patient_relationships`
   - âœ… å®‰å…¨å®¡è®¡ï¼š`audit_logs`, `security_events`, `security_audit_logs`, `security_alerts`

4. **å‰ç«¯ç»„ä»¶æ£€æŸ¥**ï¼š
   - âœ… PCç«¯ vs ç§»åŠ¨ç«¯é€»è¾‘å·®å¼‚
   - âœ… æ¶ˆæ¯æ˜¾ç¤ºï¼š`addMessage()` vs `addMobileMessage()`
   - âœ… åŒ»ç”Ÿé€‰æ‹©ï¼šäº”å¤§ååŒ»äººæ ¼ç³»ç»Ÿ
   - âœ… ä¼šè¯ç®¡ç†ï¼šlocalStorageæ•°æ®ç»“æ„
   - âœ… å†³ç­–æ ‘æ„å»ºï¼šèŠ‚ç‚¹ç¼–è¾‘ã€å³é”®èœå•ã€æ€ç»´åº“ä¿å­˜

#### ğŸ”§ å¸¸è§é”™è¯¯é˜²èŒƒ
1. **è·¯å¾„é”™è¯¯**ï¼š
   - âŒ `/static/login_portal.html` â†’ âœ… `/login` (FastAPIè·¯ç”±)
   - âŒ `/api/chat` â†’ âœ… `/api/consultation/chat`
   
2. **å˜é‡åæ··æ·†**ï¼š
   - âŒ `responseData` vs `data`å˜é‡æ··ç”¨
   - âŒ `currentUser` vs `userData`æ•°æ®ç»“æ„
   
3. **æƒé™æ§åˆ¶é—æ¼**ï¼š
   - âŒ é€€å‡ºä¸è·³è½¬ â†’ âœ… å¼ºåˆ¶è·³è½¬ç™»å½•é¡µ
   - âŒ æ•°æ®ä¸æ¸…é™¤ â†’ âœ… å®Œæ•´æ¸…é™¤ç”¨æˆ·æ•°æ®

#### ğŸ’¡ å¼€å‘æµç¨‹è¦æ±‚
1. **ä¿®æ”¹å‰**ï¼šå®Œæ•´é˜…è¯»ç›¸å…³ä»£ç ï¼Œäº†è§£ç°æœ‰é€»è¾‘
2. **å¼€å‘ä¸­**ï¼šæ·»åŠ å……è¶³çš„è°ƒè¯•æ—¥å¿—å’Œé”™è¯¯å¤„ç†  
3. **æµ‹è¯•å**ï¼šéªŒè¯PCç«¯ã€ç§»åŠ¨ç«¯ã€ä¸åŒç”¨æˆ·è§’è‰²
4. **æäº¤å‰**ï¼šæ£€æŸ¥æ˜¯å¦éµå¾ªé¡¹ç›®è§„èŒƒå’Œå®‰å…¨è¦æ±‚

###tips
1. ** æ¯æ¬¡æ–°å¢åŠŸèƒ½çš„æ—¶å€™æˆ–è€…æ–°å¢web linkçš„æ—¶å€™ä»”ç»†æ ¸æŸ¥ä¸‹ç›®å‰çš„é¡¹ç›®é‡Œæ˜¯å¦å·²ç»å­˜åœ¨äº†ï¼Œå¦‚æœå­˜åœ¨ä»”ç»†çœ‹ä¸‹ä»£ç ï¼Œæ˜¯åŸºäºå·²æœ‰çš„ä»£ç çš„åŸºç¡€ä¸Šä¿®æ”¹è¿˜æ˜¯é‡æ„ï¼Œé‡æ„çš„æ—¶å€™éœ€è¦æä¾›é‡æ„æ€è·¯å’Œé‡æ„å…·ä½“æ–¹æ¡ˆç»™åˆ°ç”¨æˆ·ç¡®è®¤ã€‚
2. **æ¯æ¬¡ä¿®æ”¹å·²æœ‰çš„ä»£ç åå¦‚æœé—®é¢˜è¿ç»­ä¸‰æ¬¡éƒ½æ²¡æœ‰è§£å†³ï¼Œéœ€è¦æ¢ç§æ€è·¯è¿›è¡Œtroubleshootingã€‚
3. **ğŸš¨ æ¯æ¬¡å›ç­”å‰å¿…é¡»å…ˆReviewç³»ç»Ÿæ ¸å¿ƒåŠŸèƒ½ï¼Œé¿å…åŸºç¡€é”™è¯¯**

---

## é¡¹ç›®ç»´æŠ¤

**æ–‡æ¡£æ›´æ–°åè®®**: æ‰€æœ‰é‡å¤§åŠŸèƒ½å˜æ›´ã€æ¶æ„è°ƒæ•´ã€é‡è¦bugä¿®å¤éƒ½å¿…é¡»åŒæ­¥æ›´æ–°æœ¬æ–‡æ¡£

**ğŸ”§ å¼€å‘è´¨é‡ç®¡ç†**: 
- **é”™è¯¯é˜²èŒƒ**: å‚è€ƒ `DEVELOPMENT_GUIDELINES.md` é¿å…é‡å¤æ€§é”™è¯¯
- **ä»£ç å®¡æŸ¥**: æ¯æ¬¡ä¿®æ”¹å‰åä½¿ç”¨æ ‡å‡†æ£€æŸ¥æ¸…å•
- **æŒç»­å­¦ä¹ **: è®°å½•æ–°é”™è¯¯æ¨¡å¼ï¼Œæ›´æ–°é˜²èŒƒæªæ–½

**å¼€å‘å›¢é˜Ÿ**: TCM-AI Development Team  
**æœ€åæ›´æ–°**: 2025-09-24  
**æ–‡æ¡£ç‰ˆæœ¬**: v2.8 (ç³»ç»Ÿæ¶æ„ç°çŠ¶ç‰ˆ)

---

*æœ¬æ–‡æ¡£ä¸ºTCM-AIé¡¹ç›®çš„æ ¸å¿ƒæŒ‡ä»¤æ–‡æ¡£ï¼ŒåŒ…å«ç³»ç»Ÿæ¶æ„ã€å¼€å‘è§„èŒƒã€éƒ¨ç½²æŒ‡å—å’Œç»´æŠ¤æ ‡å‡†ã€‚è¯·ä¸¥æ ¼éµå¾ªæœ¬æ–‡æ¡£è¿›è¡Œç³»ç»Ÿå¼€å‘å’Œç»´æŠ¤å·¥ä½œã€‚*