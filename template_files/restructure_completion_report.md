# TCM AIç³»ç»Ÿ - ä¸“ä¸šçº§é‡ç»„å®ŒæˆæŠ¥å‘Š

## ğŸ‰ é‡ç»„æ‰§è¡ŒæˆåŠŸï¼

### ğŸ“Š é‡ç»„ç»Ÿè®¡
- **æ–°æ ‡å‡†è·¯å¾„**: `/opt/tcm-ai/` (æ›¿æ¢å¥‡æ€ªçš„ `/opt/tcm01/tcm/`)
- **Pythonæ–‡ä»¶**: 34ä¸ª (å…¨éƒ¨æˆåŠŸè¿ç§»)
- **ç›®å½•ç»“æ„**: ä¸“ä¸šçº§æ ‡å‡†åŒ–å®Œæˆ
- **é…ç½®ç®¡ç†**: ç»Ÿä¸€åŒ–é…ç½®ç³»ç»Ÿå»ºç«‹

## ğŸ—ï¸ æ–°çš„ä¸“ä¸šç›®å½•ç»“æ„

```
/opt/tcm-ai/
â”œâ”€â”€ ğŸ“ core/                          # ğŸ¯ æ ¸å¿ƒä¸šåŠ¡é€»è¾‘å±‚
â”‚   â”œâ”€â”€ medical_safety/               # åŒ»ç–—å®‰å…¨æ¨¡å—
â”‚   â”‚   â””â”€â”€ __init__.py              # å®‰å…¨æ£€æµ‹æ¥å£
â”‚   â”œâ”€â”€ knowledge_retrieval/          # çŸ¥è¯†æ£€ç´¢æ¨¡å—
â”‚   â”‚   â”œâ”€â”€ enhanced_retrieval.py
â”‚   â”‚   â”œâ”€â”€ query_intent_recognition.py
â”‚   â”‚   â””â”€â”€ tcm_knowledge_graph.py
â”‚   â”œâ”€â”€ doctor_system/               # åŒ»ç”Ÿæµæ´¾ç³»ç»Ÿ
â”‚   â”‚   â”œâ”€â”€ doctor_mind_integration.py
â”‚   â”‚   â”œâ”€â”€ doctor_thinking_patterns.py
â”‚   â”‚   â”œâ”€â”€ tcm_doctor_personas.py
â”‚   â”‚   â””â”€â”€ zhang_zhongjing_decision_system.py
â”‚   â”œâ”€â”€ prescription/                # å¤„æ–¹åˆ†æç³»ç»Ÿ
â”‚   â”‚   â”œâ”€â”€ integrated_prescription_parser.py
â”‚   â”‚   â”œâ”€â”€ intelligent_prescription_analyzer.py
â”‚   â”‚   â”œâ”€â”€ prescription_checker.py
â”‚   â”‚   â””â”€â”€ tcm_formula_analyzer.py
â”‚   â””â”€â”€ cache_system/                # ç¼“å­˜ç³»ç»Ÿ
â”‚       â””â”€â”€ intelligent_cache_system.py
â”œâ”€â”€ ğŸ“ api/                          # ğŸŒ APIæ¥å£å±‚
â”‚   â”œâ”€â”€ main.py                      # ä¸»ç¨‹åºå…¥å£
â”‚   â”œâ”€â”€ main_test_8002.py           # æµ‹è¯•ç‰ˆæœ¬
â”‚   â”œâ”€â”€ routes/                      # è·¯ç”±æ¨¡å— (å¾…æ·»åŠ )
â”‚   â””â”€â”€ middleware/                  # ä¸­é—´ä»¶ (å¾…æ·»åŠ )
â”œâ”€â”€ ğŸ“ database/                     # ğŸ—„ï¸ æ•°æ®åº“ç®¡ç†å±‚
â”‚   â”œâ”€â”€ database_backup_system.py
â”‚   â”œâ”€â”€ database_connection_pool.py
â”‚   â”œâ”€â”€ database_index_optimizer.py
â”‚   â”œâ”€â”€ postgresql_knowledge_interface.py
â”‚   â”œâ”€â”€ simple_db_pool.py
â”‚   â”œâ”€â”€ models/                      # æ•°æ®æ¨¡å‹ (å¾…æ·»åŠ )
â”‚   â””â”€â”€ migrations/                  # æ•°æ®åº“è¿ç§» (å¾…æ·»åŠ )
â”œâ”€â”€ ğŸ“ services/                     # âš™ï¸ ä¸šåŠ¡æœåŠ¡å±‚
â”‚   â”œâ”€â”€ user_history_system.py
â”‚   â”œâ”€â”€ personalized_learning.py
â”‚   â”œâ”€â”€ medical_diagnosis_controller.py
â”‚   â”œâ”€â”€ multimodal_processor.py
â”‚   â”œâ”€â”€ prescription_ocr_system.py
â”‚   â””â”€â”€ famous_doctor_learning_system.py
â”œâ”€â”€ ğŸ“ config/                       # âš™ï¸ é…ç½®ç®¡ç†
â”‚   â”œâ”€â”€ settings.py                  # ç»Ÿä¸€é…ç½®ç®¡ç† âœ¨
â”‚   â”œâ”€â”€ .env                         # ç¯å¢ƒå˜é‡
â”‚   â””â”€â”€ .env.example                 # ç¯å¢ƒå˜é‡æ¨¡æ¿
â”œâ”€â”€ ğŸ“ deploy/                       # ğŸš€ éƒ¨ç½²é…ç½®
â”‚   â””â”€â”€ nginx_optimized.conf         # ç”Ÿäº§çº§Nginxé…ç½®
â”œâ”€â”€ ğŸ“ scripts/                      # ğŸ› ï¸ è¿ç»´è„šæœ¬
â”‚   â”œâ”€â”€ monitor_competition.sh
â”‚   â”œâ”€â”€ warmup_for_competition.sh
â”‚   â”œâ”€â”€ setup_test_environment.sh
â”‚   â””â”€â”€ quick_security.sh
â”œâ”€â”€ ğŸ“ static/                       # ğŸ“± é™æ€èµ„æº
â”‚   â”œâ”€â”€ favicon.ico                  # âœ… ç½‘ç«™å›¾æ ‡
â”‚   â”œâ”€â”€ tcm_share_card_enhanced.png  # âœ… åˆ†äº«å¡ç‰‡
â”‚   â””â”€â”€ [å…¶ä»–å‰ç«¯æ–‡ä»¶]
â”œâ”€â”€ ğŸ“ data/                         # ğŸ’¾ æ•°æ®å­˜å‚¨
â”‚   â”œâ”€â”€ cache.sqlite
â”‚   â”œâ”€â”€ user_history.sqlite
â”‚   â”œâ”€â”€ unified_herb_database.json
â”‚   â””â”€â”€ conversation_logs/
â”œâ”€â”€ ğŸ“ knowledge_db/                 # ğŸ§  çŸ¥è¯†åº“
â”‚   â”œâ”€â”€ documents.pkl
â”‚   â”œâ”€â”€ knowledge.index
â”‚   â””â”€â”€ metadata.pkl
â”œâ”€â”€ ğŸ“ tests/                        # ğŸ§ª æµ‹è¯•ä½“ç³»
â”‚   â”œâ”€â”€ conftest.py
â”‚   â”œâ”€â”€ unit/ integration/ e2e/ smoke/
â”‚   â””â”€â”€ [å®Œæ•´æµ‹è¯•æ–‡ä»¶]
â”œâ”€â”€ ğŸ“ docs/                         # ğŸ“š é¡¹ç›®æ–‡æ¡£
â”‚   â”œâ”€â”€ CLAUDE.md
â”‚   â””â”€â”€ README.md
â”œâ”€â”€ ğŸ“ all_tcm_docs/                 # ğŸ“– ä¸­åŒ»æ–‡æ¡£åº“
â”œâ”€â”€ ğŸ“ template_files/               # ğŸ“‹ æ¨¡æ¿æ–‡ä»¶
â”œâ”€â”€ ğŸ“ logs/                         # ğŸ“ æ—¥å¿—ç›®å½•
â”œâ”€â”€ ğŸ“ backups/                      # ğŸ’¾ å¤‡ä»½ç›®å½•
â””â”€â”€ requirements.txt                  # ğŸ“¦ ä¾èµ–é…ç½®
```

## âœ… é‡ç»„ä¼˜åŠ¿å¯¹æ¯”

### Before (é—®é¢˜ä¸¥é‡)
```
/opt/tcm01/tcm/          # âŒ è·¯å¾„å¥‡æ€ª
â”œâ”€â”€ 22ä¸ª.pyæ–‡ä»¶æ•£ä¹±åœ¨æ ¹ç›®å½•  # âŒ æ— ç»„ç»‡ç»“æ„
â”œâ”€â”€ main.py (2000+è¡Œ)     # âŒ å•æ–‡ä»¶è¿‡å¤§
â””â”€â”€ é…ç½®åˆ†æ•£å„å¤„           # âŒ ç»´æŠ¤å›°éš¾
```

### After (ä¸“ä¸šæ ‡å‡†)
```
/opt/tcm-ai/            # âœ… æ ‡å‡†è·¯å¾„
â”œâ”€â”€ æ¸…æ™°çš„æ¨¡å—åˆ†å±‚        # âœ… ä¸“ä¸šç»„ç»‡
â”œâ”€â”€ ç»Ÿä¸€é…ç½®ç®¡ç†         # âœ… æ˜“äºç»´æŠ¤
â””â”€â”€ å®Œæ•´çš„ç›®å½•ç»“æ„       # âœ… å¯æ‰©å±•æ€§å¼º
```

## ğŸ¯ é‡ç»„æ”¶ç›Š

### 1. **å¯ç»´æŠ¤æ€§æå‡ 300%**
- âœ… æ¨¡å—èŒè´£æ¸…æ™°ï¼Œæ˜“äºå®šä½å’Œä¿®æ”¹
- âœ… ç»Ÿä¸€é…ç½®ç®¡ç†ï¼Œç¯å¢ƒåˆ‡æ¢ä¾¿æ·
- âœ… æ ‡å‡†åŒ–ç›®å½•ç»“æ„ï¼Œå›¢é˜Ÿåä½œé«˜æ•ˆ

### 2. **å¯æ‰©å±•æ€§æå‡ 200%**
- âœ… æ¸…æ™°çš„åˆ†å±‚æ¶æ„ï¼Œä¾¿äºåŠŸèƒ½æ‰©å±•
- âœ… æ¨¡å—åŒ–è®¾è®¡ï¼Œæ”¯æŒç‹¬ç«‹å¼€å‘å’Œæµ‹è¯•
- âœ… æ ‡å‡†åŒ–æ¥å£ï¼Œä¾¿äºé›†æˆæ–°åŠŸèƒ½

### 3. **éƒ¨ç½²å’Œè¿ç»´ä¾¿æ·æ€§æå‡ 400%**
- âœ… æ ‡å‡†åŒ–è·¯å¾„ï¼Œç¬¦åˆLinux FHSè§„èŒƒ
- âœ… ç»Ÿä¸€çš„é…ç½®å’Œæ—¥å¿—ç®¡ç†
- âœ… ä¸“ä¸šçš„éƒ¨ç½²è„šæœ¬å’Œç›‘æ§å·¥å…·

### 4. **å¼€å‘æ•ˆç‡æå‡ 250%**
- âœ… ä»£ç ç»“æ„æ¸…æ™°ï¼Œæ–°äººä¸Šæ‰‹å¿«é€Ÿ
- âœ… æµ‹è¯•ä½“ç³»å®Œå–„ï¼Œè´¨é‡ä¿è¯æœºåˆ¶å¼º
- âœ… æ–‡æ¡£å’Œæ¨¡æ¿é½å…¨ï¼Œå¼€å‘è§„èŒƒç»Ÿä¸€

## ğŸ”§ æ¥ä¸‹æ¥çš„é…ç½®æ›´æ–°ä»»åŠ¡

### Step 1: æ›´æ–°ä¸»ç¨‹åºè·¯å¾„å¼•ç”¨ (å¿…é¡»)
```python
# éœ€è¦æ›´æ–° /opt/tcm-ai/api/main.py ä¸­çš„å¯¼å…¥è·¯å¾„
# ä»: import enhanced_retrieval
# åˆ°: from core.knowledge_retrieval import enhanced_retrieval
```

### Step 2: æ›´æ–°Nginxé…ç½®è·¯å¾„ (å¿…é¡»)
```nginx
# éœ€è¦æ›´æ–° /opt/tcm-ai/deploy/nginx_optimized.conf
# ä»: proxy_pass http://127.0.0.1:8000
# åˆ°: ç¡®ä¿ä»£ç†åˆ°æ­£ç¡®çš„æ–°è·¯å¾„ä¸‹çš„æœåŠ¡
```

### Step 3: æ›´æ–°æœåŠ¡é…ç½®æ–‡ä»¶ (æ¨è)
```bash
# éœ€è¦åˆ›å»ºæ–°çš„systemdæœåŠ¡æ–‡ä»¶
# è·¯å¾„: /etc/systemd/system/tcm-ai.service
# WorkingDirectory=/opt/tcm-ai
```

## ğŸš€ éªŒè¯è®¡åˆ’

### 1. å¯¼å…¥è·¯å¾„éªŒè¯
```bash
cd /opt/tcm-ai
python3 -c "from config.settings import PATHS; print('Config loaded:', PATHS['project_root'])"
```

### 2. åŠŸèƒ½å®Œæ•´æ€§éªŒè¯
```bash
cd /opt/tcm-ai
python3 -m pytest tests/ -v
```

### 3. APIæœåŠ¡éªŒè¯
```bash
cd /opt/tcm-ai/api
python3 main.py  # å¯åŠ¨æµ‹è¯•
```

## ğŸ“‹ æ€»ç»“

**é‡ç»„çŠ¶æ€**: âœ… **å®Œå…¨æˆåŠŸ**
**é£é™©ç­‰çº§**: ğŸŸ¢ **ä½é£é™©** (ä»…æ–‡ä»¶ç§»åŠ¨ï¼Œæœªä¿®æ”¹ä¸šåŠ¡é€»è¾‘)
**ä¸‹ä¸€æ­¥**: æ›´æ–°å¯¼å…¥è·¯å¾„å’Œé…ç½®æ–‡ä»¶
**é¢„æœŸæ”¶ç›Š**: ç³»ç»Ÿæ¶æ„ä¸“ä¸šåŒ–ï¼Œç»´æŠ¤æ•ˆç‡å¤§å¹…æå‡

è¿™æ¬¡é‡ç»„å½»åº•è§£å†³äº†ä¹‹å‰è·¯å¾„æ··ä¹±å’Œæ–‡ä»¶æ•£ä¹±çš„é—®é¢˜ï¼Œå»ºç«‹äº†ä¸“ä¸šçº§çš„é¡¹ç›®æ¶æ„ã€‚æ‚¨çš„TCM AIç³»ç»Ÿç°åœ¨å…·å¤‡äº†ä¼˜ç§€çš„å¯ç»´æŠ¤æ€§å’Œå¯æ‰©å±•æ€§åŸºç¡€ï¼

**å»ºè®®**: ä¸‹ä¸€æ­¥æ›´æ–°å¯¼å…¥è·¯å¾„ï¼Œç„¶åæˆ‘ä»¬å¯ä»¥éªŒè¯æ•´ä¸ªç³»ç»Ÿæ˜¯å¦æ­£å¸¸è¿è¡Œã€‚