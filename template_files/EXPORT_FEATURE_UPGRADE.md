# 决策树导出功能升级 - 多格式支持

## 🎉 升级概述

原有导出功能只支持JSON格式，对医生不友好。现已升级为**多格式导出**，支持4种格式，层次清晰，易于阅读。

---

## 📥 支持的导出格式

### 1. 📄 文本格式 (.txt) - **推荐医生使用**

**特点**:
- ✅ 层次分明，使用分隔线和缩进
- ✅ 可用记事本、Word等任何文本编辑器打开
- ✅ 打印友好
- ✅ 完整包含所有信息

**内容示例**:
```
════════════════════════════════════════════════════════════════════════════════
                    中医临床决策树
════════════════════════════════════════════════════════════════════════════════

📋 疾病名称: 脾胃虚寒型胃痛
📅 导出时间: 2025-10-19 20:45:30
📊 节点总数: 5

────────────────────────────────────────────────────────────────────────────────

💭 临床思维描述
────────────────────────────────────────────────────────────────────────────────
患者表现为胃痛喜温喜按，伴有神疲乏力，手足不温，大便溏薄...

────────────────────────────────────────────────────────────────────────────────

🔴 疾病/证候节点
────────────────────────────────────────────────────────────────────────────────
1. 脾胃虚寒型胃痛
   相关症状: 胃痛, 喜温喜按, 神疲乏力

🔵 症状/体征节点
────────────────────────────────────────────────────────────────────────────────
1. 胃脘隐痛，绵绵不休，喜温喜按
   相关症状: 胃痛, 喜按

🟢 处方/治疗节点
────────────────────────────────────────────────────────────────────────────────
1. 理中汤合良附丸加减
   药物: 党参、白术、干姜、炙甘草、高良姜、香附、陈皮、半夏
```

---

### 2. 📝 Markdown格式 (.md)

**特点**:
- ✅ 支持多级标题、列表、粗体
- ✅ 可用Typora、VS Code、微信公众号等打开
- ✅ 美观专业
- ✅ 易于编辑和分享

**适用场景**:
- 需要进一步编辑决策树
- 制作教学文档
- 发表文章或分享

**内容示例**:
```markdown
# 中医临床决策树 - 脾胃虚寒型胃痛

> **导出时间**: 2025-10-19 20:45:30  
> **节点总数**: 5

---

## 💭 临床思维描述

患者表现为胃痛喜温喜按，伴有神疲乏力...

## 🔴 疾病/证候节点

1. **脾胃虚寒型胃痛**
   - 相关症状: 胃痛, 喜温喜按, 神疲乏力

## 🟢 处方/治疗节点

1. **理中汤合良附丸加减**
   - 药物: 党参、白术、干姜、炙甘草...
```

---

### 3. 🌐 网页格式 (.html)

**特点**:
- ✅ 专业排版，带样式
- ✅ 可在浏览器直接打开
- ✅ 支持打印（Ctrl+P）
- ✅ 颜色区分不同类型节点

**适用场景**:
- 需要打印漂亮的文档
- 展示给同事或学生
- 制作电子文档

**特色**:
- 使用不同颜色标识节点类型：
  - 🔴 疾病节点：红色边框
  - 🔵 症状节点：蓝色边框
  - 🟡 诊断节点：黄色边框
  - 🟢 处方节点：绿色边框
- 响应式设计，适配各种屏幕
- 打印模式优化

---

### 4. 💾 JSON格式 (.json)

**特点**:
- ✅ 结构化数据
- ✅ 可编程处理
- ✅ 保留完整节点信息

**适用场景**:
- 需要导入到其他系统
- 程序化处理
- 数据备份

---

## 🎨 使用方法

### 第1步：打开决策树构建器

访问: https://mxh0510.cn/static/decision_tree_visual_builder.html

---

### 第2步：构建或加载决策树

- 创建新的决策树节点
- 或从历史记录加载已保存的决策树

---

### 第3步：选择导出格式

在右侧工具栏找到 **"📄 导出决策树"** 部分：

1. **点击下拉菜单**，选择导出格式：
   - 📄 文本格式 (.txt) - **推荐**
   - 📝 Markdown (.md)
   - 🌐 网页格式 (.html)
   - 💾 JSON数据 (.json)

2. **点击 "📥 导出" 按钮**

---

### 第4步：打开下载的文件

**文本格式 (.txt)**:
- Windows: 记事本、Word
- Mac: TextEdit、Pages
- 任何文本编辑器

**Markdown (.md)**:
- Typora (推荐)
- VS Code
- 微信公众号编辑器
- 任何Markdown编辑器

**网页格式 (.html)**:
- Chrome、Edge、Safari等浏览器
- 打开后按 Ctrl+P 可打印

**JSON (.json)**:
- VS Code、Notepad++
- 程序导入使用

---

## 📊 导出内容包含

所有格式都包含完整信息：

1. ✅ **疾病名称** - 决策树的主题
2. ✅ **导出时间** - 记录导出时间
3. ✅ **节点总数** - 决策树规模
4. ✅ **临床思维描述** - 医生的诊疗思路
5. ✅ **疾病/证候节点** - 按类型分组
6. ✅ **症状/体征节点** - 详细症状列表
7. ✅ **诊断/辨证节点** - 诊断依据
8. ✅ **处方/治疗节点** - 治疗方案
9. ✅ **决策流程** - 节点之间的连接关系

---

## 💡 推荐使用场景

### 医生日常使用
**推荐**: 📄 文本格式 (.txt)
- 简单直接，不需要特殊软件
- 可直接打印
- 易于阅读和分享

### 教学文档制作
**推荐**: 📝 Markdown (.md)
- 美观专业
- 易于编辑
- 支持格式化

### 展示和打印
**推荐**: 🌐 网页格式 (.html)
- 专业排版
- 彩色区分
- 打印效果好

### 数据备份/程序处理
**推荐**: 💾 JSON (.json)
- 结构化数据
- 可编程处理
- 完整保留信息

---

## 🎯 升级对比

### 升级前 ❌

| 项目 | 状态 |
|------|------|
| 导出格式 | 只有JSON |
| 易读性 | 代码格式，医生看不懂 |
| 打印 | 需要格式化 |
| 编辑 | 困难 |

### 升级后 ✅

| 项目 | 状态 |
|------|------|
| 导出格式 | 4种格式任选 |
| 易读性 | 层次分明，清晰易读 |
| 打印 | 直接打印，美观 |
| 编辑 | 支持多种编辑器 |

---

## 📸 界面截图说明

导出区域显示：
```
┌─────────────────────────────────────────┐
│ 📄 导出决策树                            │
├─────────────────────────────────────────┤
│ [下拉菜单: 📄 文本格式 (.txt) - 推荐 ▼] │
│ [📥 导出]                               │
├─────────────────────────────────────────┤
│ 💡 推荐使用"文本格式"，层次清晰，易于阅读 │
└─────────────────────────────────────────┘
```

---

## 🔧 技术细节

### 文件编码
所有格式使用 **UTF-8** 编码，支持中文

### 文件命名
格式: `决策树_{疾病名称}_{日期}.{扩展名}`

示例: `决策树_脾胃虚寒型胃痛_2025-10-19.txt`

### 浏览器兼容性
支持所有现代浏览器：
- Chrome ✅
- Edge ✅
- Firefox ✅
- Safari ✅

---

## 📚 相关文档

- **决策树用户指南**: `DECISION_TREE_USER_GUIDE.md`
- **决策树集成指南**: `DECISION_TREE_INTEGRATION_COMPLETE.md`

---

## ✅ 完成清单

- [x] 添加格式选择下拉菜单
- [x] 实现文本格式导出
- [x] 实现Markdown格式导出
- [x] 实现HTML格式导出
- [x] 保留原有JSON格式导出
- [x] 添加使用提示
- [x] 优化用户体验

---

**升级时间**: 2025-10-19
**升级内容**: 从单一JSON格式升级为4种格式导出
**适用人群**: 所有医生用户

---

**现在医生可以轻松导出、查看和分享决策树了！** 🎊
