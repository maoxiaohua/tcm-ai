INFO:faiss.loader:Loading faiss with AVX2 support.
INFO:faiss.loader:Successfully loaded faiss with AVX2 support.
INFO:core.cache_system.intelligent_cache_system:ç¼“å­˜æ•°æ®åº“åˆå§‹åŒ–å®Œæˆ
INFO:core.cache_system.intelligent_cache_system:æ™ºèƒ½ç¼“å­˜ç³»ç»Ÿåˆå§‹åŒ–å®Œæˆ
INFO:services.user_history_system:æ•°æ®åº“è¡¨ç»“æ„åˆå§‹åŒ–å®Œæˆï¼ˆåŒ…å«æ‰‹æœºéªŒè¯æ”¯æŒï¼‰
INFO:services.user_history_system:ç”¨æˆ·å†å²ç³»ç»Ÿåˆå§‹åŒ–å®Œæˆ
INFO:__main__:Attempted to load environment variables from .env file.
INFO:__main__:DashScope API Key is set.
INFO:services.personalized_learning:Learning database initialized successfully
INFO:__main__:Enhanced retrieval, persona and learning systems initialized successfully
INFO:database.postgresql_knowledge_interface:PostgreSQLåŒ»ç”Ÿä¸“ç”¨çŸ¥è¯†åº“æ¥å£åˆå§‹åŒ–æˆåŠŸ
INFO:database.postgresql_knowledge_interface:æ··åˆçŸ¥è¯†åº“ç³»ç»Ÿåˆå§‹åŒ–: PostgreSQL=å¯ç”¨, FAISS=å¯ç”¨
INFO:__main__:PostgreSQL hybrid knowledge system initialized successfully
INFO:core.doctor_system.doctor_thinking_patterns:æ•°æ®åº“æ–‡ä»¶ä¸å­˜åœ¨ï¼Œåˆ›å»ºæ–°æ•°æ®åº“
INFO:core.doctor_system.doctor_mind_integration:å¢å¼ºä¸ªæ€§åŒ–æ²»ç–—ç”Ÿæˆå™¨åˆå§‹åŒ–å®Œæˆ
INFO:__main__:Doctor mind decision tree system initialized successfully
INFO:api.security_integration:Setting up security system...
INFO:api.security_integration:Security system setup completed
INFO:__main__:Security system activated
INFO:__main__:ä½¿ç”¨é˜¿é‡Œäº‘qwenå¤§æ¨¡å‹ï¼ŒAgentç³»ç»Ÿå·²ç§»é™¤
INFO:     Started server process [2341335]
INFO:     Waiting for application startup.
INFO:__main__:Application startup: Initializing online-only resources...
INFO:     Application startup complete.
INFO:     Uvicorn running on http://0.0.0.0:8000 (Press CTRL+C to quit)
INFO:core.security.rbac_system:Created session for user anonymous with role anonymous
INFO:api.routes.doctor_decision_tree_routes:è¯·æ±‚æ™ºèƒ½ç”Ÿæˆå†³ç­–æ ‘: è…°ç—›
INFO:core.security.rbac_system:Created session for user anonymous with role anonymous
INFO:api.routes.doctor_decision_tree_routes:è¯·æ±‚æ™ºèƒ½ç”Ÿæˆå†³ç­–æ ‘: è…°ç—›
INFO:core.security.rbac_system:Created session for user anonymous with role anonymous
INFO:api.routes.doctor_decision_tree_routes:è¯·æ±‚æ™ºèƒ½ç”Ÿæˆå†³ç­–æ ‘: è…°ç—›
INFO:core.security.rbac_system:Created session for user anonymous with role anonymous
INFO:api.routes.doctor_decision_tree_routes:è¯·æ±‚æ™ºèƒ½ç”Ÿæˆå†³ç­–æ ‘: è…°ç—›
INFO:core.security.rbac_system:Created session for user anonymous with role anonymous
INFO:     Shutting down
INFO:     Waiting for application shutdown.
INFO:__main__:Application shutdown.
INFO:     Application shutdown complete.
INFO:     Finished server process [2341335]
âœ… AIåŠŸèƒ½å·²å¯ç”¨ï¼Œæ¨¡å‹: qwen-max
âœ… å­¦ä¹ æ•°æ®åº“è®¾ç½®å®Œæˆ
è­¦å‘Š: æ¨¡ç³Šè¯ææå–å™¨ä¸å¯ç”¨
Zhang Zhongjing decision system not available: No module named 'zhang_zhongjing_decision_system'
ğŸ“¡ APIè·¯ç”±è°ƒè¯•:
  - ç–¾ç—…åç§°: è…°ç—›
  - æ€ç»´è¿‡ç¨‹é•¿åº¦: 322
  - use_aiè®¾ä¸ºNoneï¼Œå°†è‡ªåŠ¨åˆ¤æ–­
  - è°ƒç”¨doctor_learning_system.generate_decision_paths...
ğŸ” AIå†³ç­–åˆ¤æ–­è°ƒè¯•:
  - use_aiå‚æ•°: True
  - self.ai_enabled: True
  - thinking_processé•¿åº¦: 322
  - æœ€ç»ˆä½¿ç”¨AI: True
ğŸ” AIç”Ÿæˆæ¡ä»¶æ£€æŸ¥:
  - use_ai: True (ç±»å‹: <class 'bool'>)
  - self.ai_enabled: True (ç±»å‹: <class 'bool'>)
  - thinking_process.strip(): 'æ‚£è€…ï¼Œç”·ï¼Œ45å²ï¼Œè…°ç—›3ä¸ªæœˆã€‚
    
    æˆ‘çš„è¯Šç–—åˆ†æï¼š
    1. ä¸»ç—‡ï¼šè…°éƒ¨å†·ç—›ï¼Œé‡å¯’åŠ é‡ï¼Œå–œæ¸©å–œæŒ‰
    2. å…¼ç—‡ï¼šç•å¯’è‚¢å†·ï¼Œå¤œå°¿é¢‘å¤šï¼Œç²¾ç¥ç–²å€¦
    3. èˆŒè±¡ï¼šèˆŒè´¨æ·¡èƒ–ï¼Œè‹”ç™½æ¶¦
    4. è„‰è±¡ï¼šè„‰æ²‰ç»†æ— åŠ›
    
    æˆ‘çš„è¯å‹åˆ¤æ–­ï¼šè‚¾é˜³è™šè¯
    æˆ‘çš„æ²»æ³•ï¼šæ¸©è¡¥è‚¾é˜³ï¼Œå¼ºè…°æ­¢ç—›
    æˆ‘çš„å¤„æ–¹ï¼šå³å½’ä¸¸åŠ å‡
    - ç†Ÿåœ°é»„20gï¼ˆå›è¯ï¼Œè¡¥è‚¾å¡«ç²¾ï¼‰
    - è‚‰æ¡‚6gï¼ˆè‡£è¯ï¼Œæ¸©è‚¾åŠ©é˜³ï¼‰
    - é™„å­10gï¼ˆä½è¯ï¼Œå›é˜³æ•‘é€†ï¼‰
    - å±±è¯15gï¼ˆè¡¥è„¾è‚¾ï¼‰
    - æœä»²15gï¼ˆå¼ºè…°è†ï¼‰
    - å½“å½’12gï¼ˆè¡¥è¡€æ´»è¡€ï¼‰
    
    å¸Œæœ›AIåŠ©æ‰‹å¸®æˆ‘éªŒè¯è¿™ä¸ªè¯Šç–—æ€è·¯çš„å®Œæ•´æ€§å’Œåˆç†æ€§ã€‚' (é•¿åº¦: 322)
  - bool(thinking_process.strip()): True
  - ç»¼åˆæ¡ä»¶: æ‚£è€…ï¼Œç”·ï¼Œ45å²ï¼Œè…°ç—›3ä¸ªæœˆã€‚
    
    æˆ‘çš„è¯Šç–—åˆ†æï¼š
    1. ä¸»ç—‡ï¼šè…°éƒ¨å†·ç—›ï¼Œé‡å¯’åŠ é‡ï¼Œå–œæ¸©å–œæŒ‰
    2. å…¼ç—‡ï¼šç•å¯’è‚¢å†·ï¼Œå¤œå°¿é¢‘å¤šï¼Œç²¾ç¥ç–²å€¦
    3. èˆŒè±¡ï¼šèˆŒè´¨æ·¡èƒ–ï¼Œè‹”ç™½æ¶¦
    4. è„‰è±¡ï¼šè„‰æ²‰ç»†æ— åŠ›
    
    æˆ‘çš„è¯å‹åˆ¤æ–­ï¼šè‚¾é˜³è™šè¯
    æˆ‘çš„æ²»æ³•ï¼šæ¸©è¡¥è‚¾é˜³ï¼Œå¼ºè…°æ­¢ç—›
    æˆ‘çš„å¤„æ–¹ï¼šå³å½’ä¸¸åŠ å‡
    - ç†Ÿåœ°é»„20gï¼ˆå›è¯ï¼Œè¡¥è‚¾å¡«ç²¾ï¼‰
    - è‚‰æ¡‚6gï¼ˆè‡£è¯ï¼Œæ¸©è‚¾åŠ©é˜³ï¼‰
    - é™„å­10gï¼ˆä½è¯ï¼Œå›é˜³æ•‘é€†ï¼‰
    - å±±è¯15gï¼ˆè¡¥è„¾è‚¾ï¼‰
    - æœä»²15gï¼ˆå¼ºè…°è†ï¼‰
    - å½“å½’12gï¼ˆè¡¥è¡€æ´»è¡€ï¼‰
    
    å¸Œæœ›AIåŠ©æ‰‹å¸®æˆ‘éªŒè¯è¿™ä¸ªè¯Šç–—æ€è·¯çš„å®Œæ•´æ€§å’Œåˆç†æ€§ã€‚
ğŸ¤– ä½¿ç”¨AIæ™ºèƒ½ç”Ÿæˆ: è…°ç—›
âŒ å†³ç­–è·¯å¾„ç”Ÿæˆå¤±è´¥: name 'medical_syndrome' is not defined
ğŸ“¡ APIè·¯ç”±è¿”å›ç»“æœ:
  - source: template_fallback
  - ai_generated: True
  - user_thinking_used: True
ğŸ“¡ APIè·¯ç”±è°ƒè¯•:
  - ç–¾ç—…åç§°: è…°ç—›
  - æ€ç»´è¿‡ç¨‹é•¿åº¦: 322
  - use_aiè®¾ä¸ºNoneï¼Œå°†è‡ªåŠ¨åˆ¤æ–­
  - è°ƒç”¨doctor_learning_system.generate_decision_paths...
ğŸ” AIå†³ç­–åˆ¤æ–­è°ƒè¯•:
  - use_aiå‚æ•°: True
  - self.ai_enabled: True
  - thinking_processé•¿åº¦: 322
  - æœ€ç»ˆä½¿ç”¨AI: True
ğŸ” AIç”Ÿæˆæ¡ä»¶æ£€æŸ¥:
  - use_ai: True (ç±»å‹: <class 'bool'>)
  - self.ai_enabled: True (ç±»å‹: <class 'bool'>)
  - thinking_process.strip(): 'æ‚£è€…ï¼Œç”·ï¼Œ45å²ï¼Œè…°ç—›3ä¸ªæœˆã€‚
    
    æˆ‘çš„è¯Šç–—åˆ†æï¼š
    1. ä¸»ç—‡ï¼šè…°éƒ¨å†·ç—›ï¼Œé‡å¯’åŠ é‡ï¼Œå–œæ¸©å–œæŒ‰
    2. å…¼ç—‡ï¼šç•å¯’è‚¢å†·ï¼Œå¤œå°¿é¢‘å¤šï¼Œç²¾ç¥ç–²å€¦
    3. èˆŒè±¡ï¼šèˆŒè´¨æ·¡èƒ–ï¼Œè‹”ç™½æ¶¦
    4. è„‰è±¡ï¼šè„‰æ²‰ç»†æ— åŠ›
    
    æˆ‘çš„è¯å‹åˆ¤æ–­ï¼šè‚¾é˜³è™šè¯
    æˆ‘çš„æ²»æ³•ï¼šæ¸©è¡¥è‚¾é˜³ï¼Œå¼ºè…°æ­¢ç—›
    æˆ‘çš„å¤„æ–¹ï¼šå³å½’ä¸¸åŠ å‡
    - ç†Ÿåœ°é»„20gï¼ˆå›è¯ï¼Œè¡¥è‚¾å¡«ç²¾ï¼‰
    - è‚‰æ¡‚6gï¼ˆè‡£è¯ï¼Œæ¸©è‚¾åŠ©é˜³ï¼‰
    - é™„å­10gï¼ˆä½è¯ï¼Œå›é˜³æ•‘é€†ï¼‰
    - å±±è¯15gï¼ˆè¡¥è„¾è‚¾ï¼‰
    - æœä»²15gï¼ˆå¼ºè…°è†ï¼‰
    - å½“å½’12gï¼ˆè¡¥è¡€æ´»è¡€ï¼‰
    
    å¸Œæœ›AIåŠ©æ‰‹å¸®æˆ‘éªŒè¯è¿™ä¸ªè¯Šç–—æ€è·¯çš„å®Œæ•´æ€§å’Œåˆç†æ€§ã€‚' (é•¿åº¦: 322)
  - bool(thinking_process.strip()): True
  - ç»¼åˆæ¡ä»¶: æ‚£è€…ï¼Œç”·ï¼Œ45å²ï¼Œè…°ç—›3ä¸ªæœˆã€‚
    
    æˆ‘çš„è¯Šç–—åˆ†æï¼š
    1. ä¸»ç—‡ï¼šè…°éƒ¨å†·ç—›ï¼Œé‡å¯’åŠ é‡ï¼Œå–œæ¸©å–œæŒ‰
    2. å…¼ç—‡ï¼šç•å¯’è‚¢å†·ï¼Œå¤œå°¿é¢‘å¤šï¼Œç²¾ç¥ç–²å€¦
    3. èˆŒè±¡ï¼šèˆŒè´¨æ·¡èƒ–ï¼Œè‹”ç™½æ¶¦
    4. è„‰è±¡ï¼šè„‰æ²‰ç»†æ— åŠ›
    
    æˆ‘çš„è¯å‹åˆ¤æ–­ï¼šè‚¾é˜³è™šè¯
    æˆ‘çš„æ²»æ³•ï¼šæ¸©è¡¥è‚¾é˜³ï¼Œå¼ºè…°æ­¢ç—›
    æˆ‘çš„å¤„æ–¹ï¼šå³å½’ä¸¸åŠ å‡
    - ç†Ÿåœ°é»„20gï¼ˆå›è¯ï¼Œè¡¥è‚¾å¡«ç²¾ï¼‰
    - è‚‰æ¡‚6gï¼ˆè‡£è¯ï¼Œæ¸©è‚¾åŠ©é˜³ï¼‰
    - é™„å­10gï¼ˆä½è¯ï¼Œå›é˜³æ•‘é€†ï¼‰
    - å±±è¯15gï¼ˆè¡¥è„¾è‚¾ï¼‰
    - æœä»²15gï¼ˆå¼ºè…°è†ï¼‰
    - å½“å½’12gï¼ˆè¡¥è¡€æ´»è¡€ï¼‰
    
    å¸Œæœ›AIåŠ©æ‰‹å¸®æˆ‘éªŒè¯è¿™ä¸ªè¯Šç–—æ€è·¯çš„å®Œæ•´æ€§å’Œåˆç†æ€§ã€‚
ğŸ¤– ä½¿ç”¨AIæ™ºèƒ½ç”Ÿæˆ: è…°ç—›
âŒ å†³ç­–è·¯å¾„ç”Ÿæˆå¤±è´¥: name 'medical_syndrome' is not defined
ğŸ“¡ APIè·¯ç”±è¿”å›ç»“æœ:
  - source: template_fallback
  - ai_generated: True
  - user_thinking_used: True
ğŸ“¡ APIè·¯ç”±è°ƒè¯•:
  - ç–¾ç—…åç§°: è…°ç—›
  - æ€ç»´è¿‡ç¨‹é•¿åº¦: 39
  - use_aiè®¾ä¸ºNoneï¼Œå°†è‡ªåŠ¨åˆ¤æ–­
  - è°ƒç”¨doctor_learning_system.generate_decision_paths...
ğŸ” AIå†³ç­–åˆ¤æ–­è°ƒè¯•:
  - use_aiå‚æ•°: True
  - self.ai_enabled: True
  - thinking_processé•¿åº¦: 39
  - æœ€ç»ˆä½¿ç”¨AI: True
ğŸ” AIç”Ÿæˆæ¡ä»¶æ£€æŸ¥:
  - use_ai: True (ç±»å‹: <class 'bool'>)
  - self.ai_enabled: True (ç±»å‹: <class 'bool'>)
  - thinking_process.strip(): 'æ‚£è€…è…°ç—›ï¼Œè‚¾é˜³è™šè¯ã€‚å³å½’ä¸¸åŠ å‡ï¼šç†Ÿåœ°é»„20gï¼Œè‚‰æ¡‚6gï¼Œé™„å­10gã€‚æ¸©è¡¥è‚¾é˜³ã€‚' (é•¿åº¦: 39)
  - bool(thinking_process.strip()): True
  - ç»¼åˆæ¡ä»¶: æ‚£è€…è…°ç—›ï¼Œè‚¾é˜³è™šè¯ã€‚å³å½’ä¸¸åŠ å‡ï¼šç†Ÿåœ°é»„20gï¼Œè‚‰æ¡‚6gï¼Œé™„å­10gã€‚æ¸©è¡¥è‚¾é˜³ã€‚
ğŸ¤– ä½¿ç”¨AIæ™ºèƒ½ç”Ÿæˆ: è…°ç—›
âŒ å†³ç­–è·¯å¾„ç”Ÿæˆå¤±è´¥: name 'medical_syndrome' is not defined
ğŸ“¡ APIè·¯ç”±è¿”å›ç»“æœ:
  - source: template_fallback
  - ai_generated: True
  - user_thinking_used: True
ğŸ“¡ APIè·¯ç”±è°ƒè¯•:
  - ç–¾ç—…åç§°: è…°ç—›
  - æ€ç»´è¿‡ç¨‹é•¿åº¦: 39
  - use_aiè®¾ä¸ºNoneï¼Œå°†è‡ªåŠ¨åˆ¤æ–­
  - è°ƒç”¨doctor_learning_system.generate_decision_paths...
ğŸ” AIå†³ç­–åˆ¤æ–­è°ƒè¯•:
  - use_aiå‚æ•°: True
  - self.ai_enabled: True
  - thinking_processé•¿åº¦: 39
  - æœ€ç»ˆä½¿ç”¨AI: True
ğŸ” AIç”Ÿæˆæ¡ä»¶æ£€æŸ¥:
  - use_ai: True (ç±»å‹: <class 'bool'>)
  - self.ai_enabled: True (ç±»å‹: <class 'bool'>)
  - thinking_process.strip(): 'æ‚£è€…è…°ç—›ï¼Œè‚¾é˜³è™šè¯ã€‚å³å½’ä¸¸åŠ å‡ï¼šç†Ÿåœ°é»„20gï¼Œè‚‰æ¡‚6gï¼Œé™„å­10gã€‚æ¸©è¡¥è‚¾é˜³ã€‚' (é•¿åº¦: 39)
  - bool(thinking_process.strip()): True
  - ç»¼åˆæ¡ä»¶: æ‚£è€…è…°ç—›ï¼Œè‚¾é˜³è™šè¯ã€‚å³å½’ä¸¸åŠ å‡ï¼šç†Ÿåœ°é»„20gï¼Œè‚‰æ¡‚6gï¼Œé™„å­10gã€‚æ¸©è¡¥è‚¾é˜³ã€‚
ğŸ¤– ä½¿ç”¨AIæ™ºèƒ½ç”Ÿæˆ: è…°ç—›
âŒ å†³ç­–è·¯å¾„ç”Ÿæˆå¤±è´¥: name 'medical_syndrome' is not defined
ğŸ“¡ APIè·¯ç”±è¿”å›ç»“æœ:
  - source: template_fallback
  - ai_generated: True
  - user_thinking_used: True
