<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ç§»åŠ¨ç«¯è°ƒè¯•ä¿¡æ¯å¯è§æ€§æµ‹è¯•</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            padding: 20px;
            line-height: 1.6;
        }
        .test-container {
            max-width: 600px;
            margin: 0 auto;
        }
        .test-item {
            background: #f5f5f5;
            padding: 15px;
            margin: 10px 0;
            border-radius: 8px;
        }
        .test-result {
            font-weight: bold;
            margin-top: 10px;
        }
        .pass { color: green; }
        .fail { color: red; }
        .info { color: blue; }
        button {
            background: #4CAF50;
            color: white;
            padding: 10px 20px;
            border: none;
            border-radius: 4px;
            cursor: pointer;
            margin: 5px;
        }
        .debug-info {
            position: fixed;
            bottom: 10px;
            right: 10px;
            background: rgba(0,0,0,0.8);
            color: white;
            padding: 8px 12px;
            border-radius: 20px;
            font-size: 11px;
            display: none;
        }
    </style>
</head>
<body>
    <div class="test-container">
        <h1>ç§»åŠ¨ç«¯è°ƒè¯•ä¿¡æ¯å¯è§æ€§æµ‹è¯•</h1>
        
        <div class="test-item">
            <h3>æµ‹è¯•1: ç¯å¢ƒæ£€æµ‹</h3>
            <p>å½“å‰ç¯å¢ƒä¿¡æ¯:</p>
            <ul>
                <li>ä¸»æœºå: <span id="hostname"></span></li>
                <li>ç«¯å£: <span id="port"></span></li>
                <li>å±å¹•å®½åº¦: <span id="screenWidth"></span>px</li>
                <li>ç”¨æˆ·ä»£ç†: <span id="userAgent"></span></li>
            </ul>
            <div class="test-result" id="envResult"></div>
        </div>
        
        <div class="test-item">
            <h3>æµ‹è¯•2: è°ƒè¯•ä¿¡æ¯é»˜è®¤å¯è§æ€§</h3>
            <p>æ£€æŸ¥é¡µé¢åŠ è½½æ—¶è°ƒè¯•ä¿¡æ¯æ˜¯å¦é»˜è®¤æ˜¾ç¤º</p>
            <button onclick="checkDefaultVisibility()">æ£€æŸ¥é»˜è®¤çŠ¶æ€</button>
            <div class="test-result" id="defaultResult"></div>
        </div>
        
        <div class="test-item">
            <h3>æµ‹è¯•3: è°ƒè¯•æ¨¡å¼è§¦å‘</h3>
            <p>æµ‹è¯•æ˜¯å¦éœ€è¦ç‰¹æ®Šæ“ä½œæ‰èƒ½æ˜¾ç¤ºè°ƒè¯•ä¿¡æ¯</p>
            <button onclick="simulateDebugTrigger()">æ¨¡æ‹Ÿè°ƒè¯•è§¦å‘</button>
            <div class="test-result" id="debugResult"></div>
        </div>
        
        <div class="test-item">
            <h3>æµ‹è¯•4: URLå‚æ•°æ§åˆ¶</h3>
            <p>æµ‹è¯•URLå‚æ•°å¯¹è°ƒè¯•ä¿¡æ¯çš„æ§åˆ¶</p>
            <button onclick="testUrlParams()">æµ‹è¯•å‚æ•°æ§åˆ¶</button>
            <div class="test-result" id="urlResult"></div>
        </div>
        
        <div class="test-item">
            <h3>é¢„æœŸç»“æœ</h3>
            <ul>
                <li>âœ… ç”Ÿäº§ç¯å¢ƒ(8000ç«¯å£)ï¼šè°ƒè¯•ä¿¡æ¯åº”è¯¥é»˜è®¤éšè—</li>
                <li>âœ… å¼€å‘ç¯å¢ƒ(localhost/7789/3000ç«¯å£)ï¼šå¯ä»¥æ˜¾ç¤ºè°ƒè¯•ä¿¡æ¯</li>
                <li>âœ… URLå‚æ•°?debug=1ï¼šå¯ä»¥å¼ºåˆ¶æ˜¾ç¤ºè°ƒè¯•ä¿¡æ¯</li>
                <li>âœ… æ™®é€šç”¨æˆ·ï¼šçœ‹ä¸åˆ°ä»»ä½•è°ƒè¯•ä¿¡æ¯</li>
            </ul>
        </div>
    </div>
    
    <!-- æ¨¡æ‹Ÿçš„è°ƒè¯•ä¿¡æ¯div -->
    <div id="testDebugInfo" class="debug-info">
        <span style="color: #4fc3f7;">TCM v1.2.4</span> | 
        <a href="#" style="color: #81c784; text-decoration: none;">ç½‘ç»œè¯Šæ–­</a> | 
        <a href="#" style="color: #ffb74d; text-decoration: none;">åˆ·æ–°</a> |
        <span style="color: #f48fb1; cursor: pointer;">Ã—</span>
    </div>
    
    <script>
        // ç¯å¢ƒä¿¡æ¯æ£€æµ‹
        function updateEnvironmentInfo() {
            document.getElementById('hostname').textContent = window.location.hostname;
            document.getElementById('port').textContent = window.location.port || '80';
            document.getElementById('screenWidth').textContent = window.innerWidth;
            document.getElementById('userAgent').textContent = navigator.userAgent.substring(0, 50) + '...';
            
            // æ£€æŸ¥æ˜¯å¦ä¸ºè°ƒè¯•ç¯å¢ƒ
            const isDebugEnv = isDebugMode();
            const envResult = document.getElementById('envResult');
            if (isDebugEnv) {
                envResult.innerHTML = '<span class="info">å½“å‰ç¯å¢ƒï¼šå¼€å‘/è°ƒè¯•ç¯å¢ƒ</span>';
            } else {
                envResult.innerHTML = '<span class="pass">å½“å‰ç¯å¢ƒï¼šç”Ÿäº§ç¯å¢ƒ</span>';
            }
        }
        
        // è°ƒè¯•æ¨¡å¼æ£€æµ‹å‡½æ•° (ä»å®é™…é¡µé¢å¤åˆ¶)
        function isDebugMode() {
            const urlParams = new URLSearchParams(window.location.search);
            const isLocalhost = window.location.hostname === 'localhost' || window.location.hostname === '127.0.0.1';
            const hasDebugParam = urlParams.has('debug');
            const isDevPort = window.location.port === '7789' || window.location.port === '3000';
            
            return isLocalhost || hasDebugParam || isDevPort;
        }
        
        // æ£€æŸ¥é»˜è®¤å¯è§æ€§
        function checkDefaultVisibility() {
            const debugDiv = document.getElementById('testDebugInfo');
            const isVisible = window.getComputedStyle(debugDiv).display !== 'none';
            const shouldBeVisible = window.innerWidth <= 768; // æ—§é€»è¾‘
            
            const result = document.getElementById('defaultResult');
            
            if (!isVisible) {
                result.innerHTML = '<span class="pass">âœ… è°ƒè¯•ä¿¡æ¯é»˜è®¤éšè— - æ­£ç¡®</span>';
            } else {
                result.innerHTML = '<span class="fail">âŒ è°ƒè¯•ä¿¡æ¯é»˜è®¤æ˜¾ç¤º - éœ€è¦ä¿®å¤</span>';
            }
        }
        
        // æ¨¡æ‹Ÿè°ƒè¯•è§¦å‘
        function simulateDebugTrigger() {
            const result = document.getElementById('debugResult');
            
            if (isDebugMode()) {
                result.innerHTML = '<span class="info">ğŸ”§ å¼€å‘ç¯å¢ƒï¼šå…è®¸æ˜¾ç¤ºè°ƒè¯•ä¿¡æ¯</span>';
            } else {
                result.innerHTML = '<span class="pass">âœ… ç”Ÿäº§ç¯å¢ƒï¼šéœ€è¦ç‰¹æ®Šæ“ä½œæ‰èƒ½æ˜¾ç¤ºè°ƒè¯•ä¿¡æ¯</span>';
            }
        }
        
        // æµ‹è¯•URLå‚æ•°
        function testUrlParams() {
            const urlParams = new URLSearchParams(window.location.search);
            const hasDebugParam = urlParams.has('debug');
            const result = document.getElementById('urlResult');
            
            if (hasDebugParam) {
                result.innerHTML = '<span class="info">ğŸ”§ æ£€æµ‹åˆ°debugå‚æ•°ï¼šè°ƒè¯•æ¨¡å¼æ¿€æ´»</span>';
            } else {
                result.innerHTML = '<span class="pass">âœ… æ— debugå‚æ•°ï¼šæ™®é€šç”¨æˆ·æ¨¡å¼</span>';
            }
        }
        
        // é¡µé¢åŠ è½½æ—¶æ‰§è¡Œ
        window.onload = function() {
            updateEnvironmentInfo();
            checkDefaultVisibility();
        };
    </script>
</body>
</html>